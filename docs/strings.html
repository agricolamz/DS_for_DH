<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Работа со строками | Наука о данных в R для программы Цифровых гуманитарных исследований</title>
  <meta name="description" content="5 Работа со строками | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Работа со строками | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Работа со строками | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  
  
  

<meta name="author" content="Г. А. Мороз, И. С. Поздняков" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="viz-1.html"/>
<link rel="next" href="data-presentation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Наука о данных в R для ЦГИ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Введение в R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#наука-о-данных"><i class="fa fa-check"></i><b>2.1</b> Наука о данных</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>2.2</b> Установка R и RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#полезные-ссылки"><i class="fa fa-check"></i><b>2.3</b> Полезные ссылки</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.4</b> Rstudio</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#введение-в-r"><i class="fa fa-check"></i><b>2.5</b> Введение в R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#calc"><i class="fa fa-check"></i><b>2.5.1</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#func"><i class="fa fa-check"></i><b>2.5.2</b> Функции</a></li>
<li class="chapter" data-level="2.5.3" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>2.5.3</b> Переменные</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#data_types"><i class="fa fa-check"></i><b>2.6</b> Типы данных</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#atomic"><i class="fa fa-check"></i><b>2.7</b> Вектор</a><ul>
<li class="chapter" data-level="2.7.1" data-path="intro.html"><a href="intro.html#coercion"><i class="fa fa-check"></i><b>2.7.1</b> Coercion</a></li>
<li class="chapter" data-level="2.7.2" data-path="intro.html"><a href="intro.html#vector_op"><i class="fa fa-check"></i><b>2.7.2</b> Операции с векторами</a></li>
<li class="chapter" data-level="2.7.3" data-path="intro.html"><a href="intro.html#recycling"><i class="fa fa-check"></i><b>2.7.3</b> Recycling</a></li>
<li class="chapter" data-level="2.7.4" data-path="intro.html"><a href="intro.html#index_atomic"><i class="fa fa-check"></i><b>2.7.4</b> Индексирование векторов</a></li>
<li class="chapter" data-level="2.7.5" data-path="intro.html"><a href="intro.html#na"><i class="fa fa-check"></i><b>2.7.5</b> NA — пропущенные значения</a></li>
<li class="chapter" data-level="2.7.6" data-path="intro.html"><a href="intro.html#google"><i class="fa fa-check"></i><b>2.7.6</b> В любой непонятной ситуации — ищите в поисковике</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#matrix"><i class="fa fa-check"></i><b>2.8</b> Матрицы (matrix)</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#list"><i class="fa fa-check"></i><b>2.9</b> Списки (list)</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#df"><i class="fa fa-check"></i><b>2.10</b> Data.frame</a></li>
<li class="chapter" data-level="2.11" data-path="intro.html"><a href="intro.html#real_data"><i class="fa fa-check"></i><b>2.11</b> Начинаем работу с реальными данными</a><ul>
<li class="chapter" data-level="2.11.1" data-path="intro.html"><a href="intro.html#wd"><i class="fa fa-check"></i><b>2.11.1</b> Рабочая папка и проекты</a></li>
<li class="chapter" data-level="2.11.2" data-path="intro.html"><a href="intro.html#import"><i class="fa fa-check"></i><b>2.11.2</b> Импорт данных</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="intro.html"><a href="intro.html#prep"><i class="fa fa-check"></i><b>2.12</b> Препроцессинг данных в R</a><ul>
<li class="chapter" data-level="2.12.1" data-path="intro.html"><a href="intro.html#explore"><i class="fa fa-check"></i><b>2.12.1</b> Исследование данных</a></li>
<li class="chapter" data-level="2.12.2" data-path="intro.html"><a href="intro.html#subset"><i class="fa fa-check"></i><b>2.12.2</b> Subsetting</a></li>
<li class="chapter" data-level="2.12.3" data-path="intro.html"><a href="intro.html#newcol"><i class="fa fa-check"></i><b>2.12.3</b> Создание новых колонок</a></li>
<li class="chapter" data-level="2.12.4" data-path="intro.html"><a href="intro.html#dtvstidy"><i class="fa fa-check"></i><b>2.12.4</b> data.table vs. tidyverse</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html"><i class="fa fa-check"></i><b>3</b> <code>tidyverse</code>: Загрузка и трансформация данных</a><ul>
<li class="chapter" data-level="3.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#загрузка-данных"><i class="fa fa-check"></i><b>3.1</b> Загрузка данных</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#рабочая-директория"><i class="fa fa-check"></i><b>3.1.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="3.1.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#форматы-данных-.csv"><i class="fa fa-check"></i><b>3.1.2</b> Форматы данных: <code>.csv</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#загрузка-данных-readr-readxl"><i class="fa fa-check"></i><b>3.1.3</b> Загрузка данных: readr, readxl</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#tibble"><i class="fa fa-check"></i><b>3.2</b> <code>tibble</code></a></li>
<li class="chapter" data-level="3.3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyr"><i class="fa fa-check"></i><b>3.3</b> <code>dplyr</code></a><ul>
<li class="chapter" data-level="3.3.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrfilter"><i class="fa fa-check"></i><b>3.3.1</b> <code>dplyr::filter()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrslice"><i class="fa fa-check"></i><b>3.3.2</b> <code>dplyr::slice()</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrselect"><i class="fa fa-check"></i><b>3.3.3</b> <code>dplyr::select()</code></a></li>
<li class="chapter" data-level="3.3.4" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrarrange"><i class="fa fa-check"></i><b>3.3.4</b> <code>dplyr::arrange()</code></a></li>
<li class="chapter" data-level="3.3.5" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrdistinct"><i class="fa fa-check"></i><b>3.3.5</b> <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrmutate"><i class="fa fa-check"></i><b>3.3.6</b> <code>dplyr::mutate()</code></a></li>
<li class="chapter" data-level="3.3.7" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrgroup_by...-summarise..."><i class="fa fa-check"></i><b>3.3.7</b> <code>dplyr::group_by(...) %&gt;% summarise(...)</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#соединение-датафреймов"><i class="fa fa-check"></i><b>3.4</b> Соединение датафреймов</a><ul>
<li class="chapter" data-level="3.4.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#bind_..."><i class="fa fa-check"></i><b>3.4.1</b> <code>bind_...</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyr.._join"><i class="fa fa-check"></i><b>3.4.2</b> <code>dplyr::.._join()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#tidyr-package"><i class="fa fa-check"></i><b>3.5</b> <code>tidyr</code> package</a></li>
<li class="chapter" data-level="3.6" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#полезные-надстройки"><i class="fa fa-check"></i><b>3.6</b> Полезные надстройки</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="viz-1.html"><a href="viz-1.html"><i class="fa fa-check"></i><b>4</b> Визуализация данных</a><ul>
<li class="chapter" data-level="4.1" data-path="viz-1.html"><a href="viz-1.html#зачем-визуализировать-данные"><i class="fa fa-check"></i><b>4.1</b> Зачем визуализировать данные?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="viz-1.html"><a href="viz-1.html#квартет-анскомба"><i class="fa fa-check"></i><b>4.1.1</b> Квартет Анскомба</a></li>
<li class="chapter" data-level="4.1.2" data-path="viz-1.html"><a href="viz-1.html#датазаурус"><i class="fa fa-check"></i><b>4.1.2</b> Датазаурус</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="viz-1.html"><a href="viz-1.html#основы-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Основы <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.2.1" data-path="viz-1.html"><a href="viz-1.html#диаграмма-рассеяния-scaterplot"><i class="fa fa-check"></i><b>4.2.1</b> Диаграмма рассеяния (Scaterplot)</a></li>
<li class="chapter" data-level="4.2.2" data-path="viz-1.html"><a href="viz-1.html#слои"><i class="fa fa-check"></i><b>4.2.2</b> Слои</a></li>
<li class="chapter" data-level="4.2.3" data-path="viz-1.html"><a href="viz-1.html#aes"><i class="fa fa-check"></i><b>4.2.3</b> <code>aes()</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="viz-1.html"><a href="viz-1.html#оформление"><i class="fa fa-check"></i><b>4.2.4</b> Оформление</a></li>
<li class="chapter" data-level="4.2.5" data-path="viz-1.html"><a href="viz-1.html#логарифмические-шкалы"><i class="fa fa-check"></i><b>4.2.5</b> Логарифмические шкалы</a></li>
<li class="chapter" data-level="4.2.6" data-path="viz-1.html"><a href="viz-1.html#annotate"><i class="fa fa-check"></i><b>4.2.6</b> <code>annotate()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="viz-1.html"><a href="viz-1.html#столбчатые-диаграммы-barplots"><i class="fa fa-check"></i><b>4.3</b> Столбчатые диаграммы (barplots)</a></li>
<li class="chapter" data-level="4.4" data-path="viz-1.html"><a href="viz-1.html#факторы"><i class="fa fa-check"></i><b>4.4</b> Факторы</a></li>
<li class="chapter" data-level="4.5" data-path="viz-1.html"><a href="viz-1.html#дотплот"><i class="fa fa-check"></i><b>4.5</b> Дотплот</a></li>
<li class="chapter" data-level="4.6" data-path="viz-1.html"><a href="viz-1.html#гистограммы"><i class="fa fa-check"></i><b>4.6</b> Гистограммы</a></li>
<li class="chapter" data-level="4.7" data-path="viz-1.html"><a href="viz-1.html#функции-плотности"><i class="fa fa-check"></i><b>4.7</b> Функции плотности</a></li>
<li class="chapter" data-level="4.8" data-path="viz-1.html"><a href="viz-1.html#точки-джиттер-jitter-вайолинплот-violinplot-ящики-с-усами-boxplot"><i class="fa fa-check"></i><b>4.8</b> Точки, джиттер (jitter), вайолинплот (violinplot), ящики с усами (boxplot),</a></li>
<li class="chapter" data-level="4.9" data-path="viz-1.html"><a href="viz-1.html#фасетизация"><i class="fa fa-check"></i><b>4.9</b> Фасетизация</a></li>
<li class="chapter" data-level="4.10" data-path="viz-1.html"><a href="viz-1.html#визуализация-комбинаций-признаков"><i class="fa fa-check"></i><b>4.10</b> Визуализация комбинаций признаков</a><ul>
<li class="chapter" data-level="4.10.1" data-path="viz-1.html"><a href="viz-1.html#потоковая-диаграмма-sankey-diagram"><i class="fa fa-check"></i><b>4.10.1</b> Потоковая Диаграмма (Sankey diagram)</a></li>
<li class="chapter" data-level="4.10.2" data-path="viz-1.html"><a href="viz-1.html#upset-plot"><i class="fa fa-check"></i><b>4.10.2</b> UpSet Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>5</b> Работа со строками</a><ul>
<li class="chapter" data-level="5.1" data-path="strings.html"><a href="strings.html#работа-со-строками-в-r"><i class="fa fa-check"></i><b>5.1</b> Работа со строками в R</a></li>
<li class="chapter" data-level="5.2" data-path="strings.html"><a href="strings.html#как-получить-строку"><i class="fa fa-check"></i><b>5.2</b> Как получить строку?</a></li>
<li class="chapter" data-level="5.3" data-path="strings.html"><a href="strings.html#соединение-и-разделение-строк"><i class="fa fa-check"></i><b>5.3</b> Соединение и разделение строк</a></li>
<li class="chapter" data-level="5.4" data-path="strings.html"><a href="strings.html#количество-символов"><i class="fa fa-check"></i><b>5.4</b> Количество символов</a><ul>
<li class="chapter" data-level="5.4.1" data-path="strings.html"><a href="strings.html#подсчет-количества-символов"><i class="fa fa-check"></i><b>5.4.1</b> Подсчет количества символов</a></li>
<li class="chapter" data-level="5.4.2" data-path="strings.html"><a href="strings.html#подгонка-количества-символов"><i class="fa fa-check"></i><b>5.4.2</b> Подгонка количества символов</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="strings.html"><a href="strings.html#сортировка"><i class="fa fa-check"></i><b>5.5</b> Сортировка</a></li>
<li class="chapter" data-level="5.6" data-path="strings.html"><a href="strings.html#поиск-подстроки"><i class="fa fa-check"></i><b>5.6</b> Поиск подстроки</a></li>
<li class="chapter" data-level="5.7" data-path="strings.html"><a href="strings.html#изменение-строк"><i class="fa fa-check"></i><b>5.7</b> Изменение строк</a><ul>
<li class="chapter" data-level="5.7.1" data-path="strings.html"><a href="strings.html#изменение-регистра"><i class="fa fa-check"></i><b>5.7.1</b> Изменение регистра</a></li>
<li class="chapter" data-level="5.7.2" data-path="strings.html"><a href="strings.html#выделение-подстроки"><i class="fa fa-check"></i><b>5.7.2</b> Выделение подстроки</a></li>
<li class="chapter" data-level="5.7.3" data-path="strings.html"><a href="strings.html#замена-подстроки"><i class="fa fa-check"></i><b>5.7.3</b> Замена подстроки</a></li>
<li class="chapter" data-level="5.7.4" data-path="strings.html"><a href="strings.html#удаление-подстроки"><i class="fa fa-check"></i><b>5.7.4</b> Удаление подстроки</a></li>
<li class="chapter" data-level="5.7.5" data-path="strings.html"><a href="strings.html#транслитерация-строк"><i class="fa fa-check"></i><b>5.7.5</b> Транслитерация строк</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="strings.html"><a href="strings.html#регулярные-выражения"><i class="fa fa-check"></i><b>5.8</b> Регулярные выражения</a></li>
<li class="chapter" data-level="5.9" data-path="strings.html"><a href="strings.html#определение-языка"><i class="fa fa-check"></i><b>5.9</b> Определение языка</a></li>
<li class="chapter" data-level="5.10" data-path="strings.html"><a href="strings.html#расстояния-между-строками"><i class="fa fa-check"></i><b>5.10</b> Расстояния между строками</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-presentation.html"><a href="data-presentation.html"><i class="fa fa-check"></i><b>6</b> Представление данных: rmarkdown, github, shiny</a></li>
<li class="chapter" data-level="7" data-path="tidytext.html"><a href="tidytext.html"><i class="fa fa-check"></i><b>7</b> Работа с текстами: tidytext, udpipe</a></li>
<li class="chapter" data-level="8" data-path="rvest.html"><a href="rvest.html"><i class="fa fa-check"></i><b>8</b> Сбор данных из интернета: rvest</a></li>
<li class="chapter" data-level="9" data-path="non-standard-data.html"><a href="non-standard-data.html"><i class="fa fa-check"></i><b>9</b> Нестандартные данные: время, OCR, карты</a></li>
<li class="chapter" data-level="10" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>10</b> Distributions</a></li>
<li class="chapter" data-level="11" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>11</b> Задания</a><ul>
<li class="chapter" data-level="11.1" data-path="tasks.html"><a href="tasks.html#vec_task_1"><i class="fa fa-check"></i><b>11.1</b> Вектор</a></li>
<li class="chapter" data-level="11.2" data-path="tasks.html"><a href="tasks.html#vec_op"><i class="fa fa-check"></i><b>11.2</b> Вектор. Операции с векторами</a></li>
<li class="chapter" data-level="11.3" data-path="tasks.html"><a href="tasks.html#vec_task_2"><i class="fa fa-check"></i><b>11.3</b> Вектор. Индексирование</a></li>
<li class="chapter" data-level="11.4" data-path="tasks.html"><a href="tasks.html#list_ta"><i class="fa fa-check"></i><b>11.4</b> Списки</a></li>
<li class="chapter" data-level="11.5" data-path="tasks.html"><a href="tasks.html#t"><i class="fa fa-check"></i><b>11.5</b> Матрицы</a></li>
<li class="chapter" data-level="11.6" data-path="tasks.html"><a href="tasks.html#df_task"><i class="fa fa-check"></i><b>11.6</b> Датафрейм</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>12</b> Решения_заданий</a><ul>
<li class="chapter" data-level="12.1" data-path="solutions.html"><a href="solutions.html#solvvec_task_1"><i class="fa fa-check"></i><b>12.1</b> Вектор</a></li>
<li class="chapter" data-level="12.2" data-path="solutions.html"><a href="solutions.html#solvvec_op"><i class="fa fa-check"></i><b>12.2</b> Вектор. Операции с векторами</a></li>
<li class="chapter" data-level="12.3" data-path="solutions.html"><a href="solutions.html#solvvec_task_2"><i class="fa fa-check"></i><b>12.3</b> Вектор. Индексирование</a></li>
<li class="chapter" data-level="12.4" data-path="solutions.html"><a href="solutions.html#solvlist_ta"><i class="fa fa-check"></i><b>12.4</b> Списки</a></li>
<li class="chapter" data-level="12.5" data-path="solutions.html"><a href="solutions.html#solvt"><i class="fa fa-check"></i><b>12.5</b> Матрицы</a></li>
<li class="chapter" data-level="12.6" data-path="solutions.html"><a href="solutions.html#solvdf_task"><i class="fa fa-check"></i><b>12.6</b> Датафрейм</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Наука о данных в R для программы Цифровых гуманитарных исследований</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="strings" class="section level1">
<h1><span class="header-section-number">5</span> Работа со строками</h1>
<div id="работа-со-строками-в-r" class="section level2">
<h2><span class="header-section-number">5.1</span> Работа со строками в R</h2>
<p>Для работы со строками можно использовать:</p>
<ul>
<li>базовый R</li>
<li>пакет <code>stringr</code> (часть <code>tidyverse</code>)</li>
<li>пакет <code>stringi</code> – отдельный пакет, так что не забудьте его установить:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="strings.html#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;stringi&quot;</span>)</span>
<span id="cb1-2"><a href="strings.html#cb1-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="strings.html#cb1-3"></a><span class="kw">library</span>(stringi)</span></code></pre></div>
<p>Мы будем пользоваться в основном пакетами <code>stingr</code> и <code>stringi</code>, так как они в большинстве случаях удобнее. К счастью функции этих пакетов легко отличить от остальных: функции пакет <code>stringr</code> всегда начинаются с <code>str_</code>, а функции пакета <code>stringi</code> — c <code>stri_</code>.</p>
<p>Существует <a href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf">cheat sheet по <code>stringr</code></a>.</p>
</div>
<div id="как-получить-строку" class="section level2">
<h2><span class="header-section-number">5.2</span> Как получить строку?</h2>
<ul>
<li>следите за кавычками</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="strings.html#cb2-1"></a><span class="st">&quot;the quick brown fox jumps over the lazy dog&quot;</span></span></code></pre></div>
<pre><code>## [1] &quot;the quick brown fox jumps over the lazy dog&quot;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="strings.html#cb4-1"></a><span class="st">&#39;the quick brown fox jumps over the lazy dog&#39;</span></span></code></pre></div>
<pre><code>## [1] &quot;the quick brown fox jumps over the lazy dog&quot;</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="strings.html#cb6-1"></a><span class="st">&quot;the quick &#39;brown&#39; fox jumps over the lazy dog&quot;</span></span></code></pre></div>
<pre><code>## [1] &quot;the quick &#39;brown&#39; fox jumps over the lazy dog&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="strings.html#cb8-1"></a><span class="st">&#39;the quick &quot;brown&quot; fox jumps over the lazy dog&#39;</span></span></code></pre></div>
<pre><code>## [1] &quot;the quick \&quot;brown\&quot; fox jumps over the lazy dog&quot;</code></pre>
<ul>
<li>пустая строка</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="strings.html#cb10-1"></a><span class="st">&quot;&quot;</span></span></code></pre></div>
<pre><code>## [1] &quot;&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="strings.html#cb12-1"></a><span class="st">&#39;&#39;</span></span></code></pre></div>
<pre><code>## [1] &quot;&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="strings.html#cb14-1"></a><span class="kw">character</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;&quot; &quot;&quot; &quot;&quot;</code></pre>
<ul>
<li>преобразование</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="strings.html#cb16-1"></a><span class="kw">typeof</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="strings.html#cb18-1"></a><span class="kw">as.character</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] &quot;4&quot; &quot;5&quot; &quot;6&quot; &quot;7&quot;</code></pre>
<ul>
<li>встроенные векторы</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="strings.html#cb20-1"></a>letters</span></code></pre></div>
<pre><code>##  [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; &quot;j&quot; &quot;k&quot; &quot;l&quot; &quot;m&quot; &quot;n&quot; &quot;o&quot; &quot;p&quot; &quot;q&quot;
## [18] &quot;r&quot; &quot;s&quot; &quot;t&quot; &quot;u&quot; &quot;v&quot; &quot;w&quot; &quot;x&quot; &quot;y&quot; &quot;z&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="strings.html#cb22-1"></a>LETTERS</span></code></pre></div>
<pre><code>##  [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot; &quot;K&quot; &quot;L&quot; &quot;M&quot; &quot;N&quot; &quot;O&quot; &quot;P&quot; &quot;Q&quot;
## [18] &quot;R&quot; &quot;S&quot; &quot;T&quot; &quot;U&quot; &quot;V&quot; &quot;W&quot; &quot;X&quot; &quot;Y&quot; &quot;Z&quot;</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="strings.html#cb24-1"></a>month.name</span></code></pre></div>
<pre><code>##  [1] &quot;January&quot;   &quot;February&quot;  &quot;March&quot;     &quot;April&quot;     &quot;May&quot;      
##  [6] &quot;June&quot;      &quot;July&quot;      &quot;August&quot;    &quot;September&quot; &quot;October&quot;  
## [11] &quot;November&quot;  &quot;December&quot;</code></pre>
<ul>
<li>помните, что функции <code>data.frame()</code>, <code>read.csv()</code>, <code>read.csv2()</code>, <code>read.table()</code> из базового R всегда по-умолчанию преобразуют строки в факторы, и чтобы это предотвратить нужно использовать аргумент <code>stringsAsFactors</code>. Это много обсуждалось в сообществе R, можно, например, почитать про это <a href="https://simplystatistics.org/2015/07/24/stringsasfactors-an-unauthorized-biography/">вот этот блог пост Роджера Пенга</a>.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="strings.html#cb26-1"></a><span class="kw">str</span>(<span class="kw">data.frame</span>(letters[<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>], LETTERS[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>]))</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5 obs. of  2 variables:
##  $ letters.6.10.: Factor w/ 5 levels &quot;f&quot;,&quot;g&quot;,&quot;h&quot;,&quot;i&quot;,..: 1 2 3 4 5
##  $ LETTERS.4.8. : Factor w/ 5 levels &quot;D&quot;,&quot;E&quot;,&quot;F&quot;,&quot;G&quot;,..: 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="strings.html#cb28-1"></a><span class="kw">str</span>(<span class="kw">data.frame</span>(letters[<span class="dv">6</span><span class="op">:</span><span class="dv">10</span>], LETTERS[<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5 obs. of  2 variables:
##  $ letters.6.10.: chr  &quot;f&quot; &quot;g&quot; &quot;h&quot; &quot;i&quot; ...
##  $ LETTERS.4.8. : chr  &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; ...</code></pre>
<p>Но этом курсе мы учим использовать сразу <code>tibble()</code>, <code>read_csv()</code>, <code>read_csv2()</code>, <code>read_tsv()</code>, <code>read_delim()</code> из пакета <code>readr</code> (входит в <code>tidyverse</code>).</p>
<ul>
<li>Создание рандомных строк</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="strings.html#cb30-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb30-2"><a href="strings.html#cb30-2"></a><span class="kw">stri_rand_strings</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">length =</span> <span class="dv">5</span><span class="op">:</span><span class="dv">14</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;uwHpd&quot;          &quot;Wj8ehS&quot;         &quot;ivFSwy7&quot;        &quot;TYu8zw5V&quot;      
##  [5] &quot;OuRpjoOg0&quot;      &quot;p0CubNR2yQ&quot;     &quot;xtdycKLOm2k&quot;    &quot;fAGVfylZqBGp&quot;  
##  [9] &quot;gE28DTCi0NV0a&quot;  &quot;9MemYE55If0Cvv&quot;</code></pre>
<ul>
<li>Перемешивает символы внутри строки</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="strings.html#cb32-1"></a><span class="kw">stri_rand_shuffle</span>(<span class="st">&quot;любя, съешь щипцы, — вздохнёт мэр, — кайф жгуч&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;,цо м,пюзгу   сл аиъ—в кжряд,ыщьчебэн х—штё фй&quot;</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="strings.html#cb34-1"></a><span class="kw">stri_rand_shuffle</span>(month.name)</span></code></pre></div>
<pre><code>##  [1] &quot;aJayunr&quot;   &quot;eyrbraFu&quot;  &quot;achMr&quot;     &quot;Aplri&quot;     &quot;ayM&quot;      
##  [6] &quot;Jnue&quot;      &quot;uJly&quot;      &quot;usuAgt&quot;    &quot;tpebermSe&quot; &quot;tOecrbo&quot;  
## [11] &quot;oeNembvr&quot;  &quot;Dmceerbe&quot;</code></pre>
<ul>
<li>Генерирует псевдорандомный текст<a href="ссылки-на-литературу.html#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="strings.html#cb36-1"></a><span class="kw">stri_rand_lipsum</span>(<span class="dt">nparagraphs =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Lorem ipsum dolor sit amet, donec sit nunc urna sed ultricies ac pharetra orci luctus iaculis, ac tincidunt cum. Neque eu semper at sociosqu hendrerit. Eu aliquet lacus, eu hendrerit donec aliquam eros. Risus nibh, quam in sit facilisi ipsum. Amet sem sed donec sed molestie scelerisque tincidunt. Nisl donec et facilisis interdum non sed dolor purus. In ipsum dignissim torquent velit nec aliquam pellentesque. Ac, adipiscing, neque et at torquent, vestibulum ullamcorper. Ad dictumst enim velit non nulla felis habitant. Egestas placerat consectetur, dictum nostra sed nec. Erat phasellus dolor libero aliquam viverra. Vestibulum leo et. Suscipit egestas in in montes, sapien gravida? Conubia purus varius ut nec feugiat.&quot;
## [2] &quot;Risus eleifend magnis neque diam, suspendisse ullamcorper nulla adipiscing malesuada massa, nisi sociosqu velit id et. Aliquam facilisis et aenean. Parturient vel ac in convallis, massa diam nibh. Nulla interdum cursus et. Natoque amet, ut praesent. Tortor ultrices a consectetur, augue natoque class faucibus? Ut sed arcu elementum magna. Dignissim ac facilisi quis ut nisl eu, massa.&quot;</code></pre>
</div>
<div id="соединение-и-разделение-строк" class="section level2">
<h2><span class="header-section-number">5.3</span> Соединение и разделение строк</h2>
<p>Соединенить строки можно используя функцию <code>str_c()</code>, в которую, как и в функции <code>с()</code>, можно перечислять элементы через запятую:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="strings.html#cb38-1"></a><span class="kw">tibble</span>(<span class="dt">upper =</span> <span class="kw">rev</span>(LETTERS), <span class="dt">smaller =</span> letters) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-2"><a href="strings.html#cb38-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">merge =</span> <span class="kw">str_c</span>(upper, smaller))</span></code></pre></div>
<pre><code>## # A tibble: 26 x 3
##    upper smaller merge
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;
##  1 Z     a       Za   
##  2 Y     b       Yb   
##  3 X     c       Xc   
##  4 W     d       Wd   
##  5 V     e       Ve   
##  6 U     f       Uf   
##  7 T     g       Tg   
##  8 S     h       Sh   
##  9 R     i       Ri   
## 10 Q     j       Qj   
## # … with 16 more rows</code></pre>
<p>Кроме того, если хочется, можно использовать особенный разделитель, указав его в аргументе <code>sep</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="strings.html#cb40-1"></a><span class="kw">tibble</span>(<span class="dt">upper =</span> <span class="kw">rev</span>(LETTERS), <span class="dt">smaller =</span> letters) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-2"><a href="strings.html#cb40-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">merge =</span> <span class="kw">str_c</span>(upper, smaller, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 26 x 3
##    upper smaller merge
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;
##  1 Z     a       Z_a  
##  2 Y     b       Y_b  
##  3 X     c       X_c  
##  4 W     d       W_d  
##  5 V     e       V_e  
##  6 U     f       U_f  
##  7 T     g       T_g  
##  8 S     h       S_h  
##  9 R     i       R_i  
## 10 Q     j       Q_j  
## # … with 16 more rows</code></pre>
<p>Аналогичным образом, для разделение строки на подстроки можно использовать функцию <code>separate()</code>. Это функция разносит разделенные элементы строки в соответствующие столбцы. У функции три обязательных аргумента: <code>col</code> — колонка, которую следует разделить, <code>into</code> — вектор названий новых столбец, <code>sep</code> — разделитель.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="strings.html#cb42-1"></a><span class="kw">tibble</span>(<span class="dt">upper =</span> <span class="kw">rev</span>(LETTERS), <span class="dt">smaller =</span> letters) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-2"><a href="strings.html#cb42-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">merge =</span> <span class="kw">str_c</span>(upper, smaller, <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-3"><a href="strings.html#cb42-3"></a><span class="st">  </span><span class="kw">separate</span>(<span class="dt">col =</span> merge, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;column_1&quot;</span>, <span class="st">&quot;column_2&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 26 x 4
##    upper smaller column_1 column_2
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   
##  1 Z     a       Z        a       
##  2 Y     b       Y        b       
##  3 X     c       X        c       
##  4 W     d       W        d       
##  5 V     e       V        e       
##  6 U     f       U        f       
##  7 T     g       T        g       
##  8 S     h       S        h       
##  9 R     i       R        i       
## 10 Q     j       Q        j       
## # … with 16 more rows</code></pre>
</div>
<div id="количество-символов" class="section level2">
<h2><span class="header-section-number">5.4</span> Количество символов</h2>
<div id="подсчет-количества-символов" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Подсчет количества символов</h3>
<p><img src="images/5.01_str_length.png" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="strings.html#cb44-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-2"><a href="strings.html#cb44-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_charactars =</span> <span class="kw">str_count</span>(mn))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        n_charactars
##    &lt;chr&gt;            &lt;int&gt;
##  1 January              7
##  2 February             8
##  3 March                5
##  4 April                5
##  5 May                  3
##  6 June                 4
##  7 July                 4
##  8 August               6
##  9 September            9
## 10 October              7
## 11 November             8
## 12 December             8</code></pre>
</div>
<div id="подгонка-количества-символов" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Подгонка количества символов</h3>
<p>Можно обрезать строки, используя функцию <code>str_trunc()</code>:</p>
<p><img src="images/5.02_str_trunc.png" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="strings.html#cb46-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-2"><a href="strings.html#cb46-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mn_new =</span> <span class="kw">str_trunc</span>(month.name, <span class="dv">6</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mn_new
##    &lt;chr&gt;     &lt;chr&gt; 
##  1 January   Jan...
##  2 February  Feb...
##  3 March     March 
##  4 April     April 
##  5 May       May   
##  6 June      June  
##  7 July      July  
##  8 August    August
##  9 September Sep...
## 10 October   Oct...
## 11 November  Nov...
## 12 December  Dec...</code></pre>
<p>Можно решить с какой стороны обрезать, используя аргумент <code>side</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="strings.html#cb48-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-2"><a href="strings.html#cb48-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mn_new =</span> <span class="kw">str_trunc</span>(month.name, <span class="dv">6</span>, <span class="dt">side =</span> <span class="st">&quot;left&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mn_new
##    &lt;chr&gt;     &lt;chr&gt; 
##  1 January   ...ary
##  2 February  ...ary
##  3 March     March 
##  4 April     April 
##  5 May       May   
##  6 June      June  
##  7 July      July  
##  8 August    August
##  9 September ...ber
## 10 October   ...ber
## 11 November  ...ber
## 12 December  ...ber</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="strings.html#cb50-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb50-2"><a href="strings.html#cb50-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mn_new =</span> <span class="kw">str_trunc</span>(month.name, <span class="dv">6</span>, <span class="dt">side =</span> <span class="st">&quot;center&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mn_new
##    &lt;chr&gt;     &lt;chr&gt; 
##  1 January   Ja...y
##  2 February  Fe...y
##  3 March     March 
##  4 April     April 
##  5 May       May   
##  6 June      June  
##  7 July      July  
##  8 August    August
##  9 September Se...r
## 10 October   Oc...r
## 11 November  No...r
## 12 December  De...r</code></pre>
<p>Можно заменить многоточие, используя аргумент <code>ellipsis</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="strings.html#cb52-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb52-2"><a href="strings.html#cb52-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mn_new =</span> <span class="kw">str_trunc</span>(month.name, <span class="dv">3</span>, <span class="dt">ellipsis =</span> <span class="st">&quot;&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mn_new
##    &lt;chr&gt;     &lt;chr&gt; 
##  1 January   Jan   
##  2 February  Feb   
##  3 March     Mar   
##  4 April     Apr   
##  5 May       May   
##  6 June      Jun   
##  7 July      Jul   
##  8 August    Aug   
##  9 September Sep   
## 10 October   Oct   
## 11 November  Nov   
## 12 December  Dec</code></pre>
<p>Можно наоборот “раздуть” строку:</p>
<p><img src="images/5.03_str_pad.png" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="strings.html#cb54-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-2"><a href="strings.html#cb54-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mn_new =</span> <span class="kw">str_pad</span>(month.name, <span class="dv">10</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mn_new      
##    &lt;chr&gt;     &lt;chr&gt;       
##  1 January   &quot;   January&quot;
##  2 February  &quot;  February&quot;
##  3 March     &quot;     March&quot;
##  4 April     &quot;     April&quot;
##  5 May       &quot;       May&quot;
##  6 June      &quot;      June&quot;
##  7 July      &quot;      July&quot;
##  8 August    &quot;    August&quot;
##  9 September &quot; September&quot;
## 10 October   &quot;   October&quot;
## 11 November  &quot;  November&quot;
## 12 December  &quot;  December&quot;</code></pre>
<p>Опять же есть аргумент <code>side</code>:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="strings.html#cb56-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb56-2"><a href="strings.html#cb56-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mn_new =</span> <span class="kw">str_pad</span>(month.name, <span class="dv">10</span>,  <span class="dt">side =</span> <span class="st">&quot;right&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mn_new      
##    &lt;chr&gt;     &lt;chr&gt;       
##  1 January   &quot;January   &quot;
##  2 February  &quot;February  &quot;
##  3 March     &quot;March     &quot;
##  4 April     &quot;April     &quot;
##  5 May       &quot;May       &quot;
##  6 June      &quot;June      &quot;
##  7 July      &quot;July      &quot;
##  8 August    &quot;August    &quot;
##  9 September &quot;September &quot;
## 10 October   &quot;October   &quot;
## 11 November  &quot;November  &quot;
## 12 December  &quot;December  &quot;</code></pre>
<div class="rmdtask">
<p>
На Pudding вышла <a href="https://pudding.cool/2019/10/pubs/">статья про английские пабы</a>. <a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/UK_pubs.csv">Здесь</a> лежит немного обработанный датасет, которые они использовали. Визуализируйте 50 самых частотоных названий пабов в Великобритании, отложив по оси x количество символов, а по оси y – количество баров с таким названием.
</p>
</div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<details>
<p><summary> 📋 список подсказок ➡ </summary></p>
<details>
<summary> 👁 Датасет скачался, что дальше? ➡ </summary>
Перво-наперво следует создать переменную, в которой бы хранилось количество каждого из баров. <br>
</details>
<details>
<summary> 👁 А как посчитать количество баров? ➡ </summary>
Это можно сделать при помощи функции <code>count()</code>. <br>
</details>
<details>
<summary> 👁 Бары пересчитали, что дальше? ➡ </summary>
Теперь нужно создать новую переменную, где бы хранилась информация о количестве символов. <br>
</details>
<details>
<summary> 👁 Все переменные есть, теперь рисуем? ➡ </summary>
Не совсем. Перед тем как рисовать нужно отфильтровать 50 самых популярных. <br>
</details>
<details>
<summary> 👁 Так, все готово, а какие <code>geom_()</code>? ➡ </summary>
На графике <code>geom_point()</code> и <code>geom_text_repel()</code> из пакета <code>ggrepel</code>. <br>
</details>
<details>
<summary> 👁 А-а-а-а! <code>could not find function "geom_text_repel"</code> ➡ </summary>
А вы включили библиотеку <code>ggrepel</code>? Если не включили, то функция, естественно будет недоступна. <br>
</details>
<details>
<summary> 👁 А-а-а-а! <code>geom_text_repel requires the following missing aesthetics: label"</code> ➡ </summary>
Все, как написала программа: чтобы писать какой-то текст в функции <code>aes()</code> нужно добавить аргумент <code>label = pub_name</code>. Иначе откуда он узнает, что ему писать? <br>
</details>
<details>
<summary> 👁 Фуф! Все готово! ➡ </summary>
А оси подписаны? А заголовок? А подпись про источник данных? <br>
</details>
</details>
</div>
</div>
<div id="сортировка" class="section level2">
<h2><span class="header-section-number">5.5</span> Сортировка</h2>
<p>Для сортировки существует базовая функция <code>sort()</code> и функция из <code>stringr</code> <code>str_sort()</code>:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="strings.html#cb58-1"></a>unsorted_latin &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;I&quot;</span>, <span class="st">&quot;♥&quot;</span>, <span class="st">&quot;N&quot;</span>, <span class="st">&quot;Y&quot;</span>)</span>
<span id="cb58-2"><a href="strings.html#cb58-2"></a><span class="kw">sort</span>(unsorted_latin)</span></code></pre></div>
<pre><code>## [1] &quot;♥&quot; &quot;I&quot; &quot;N&quot; &quot;Y&quot;</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="strings.html#cb60-1"></a><span class="kw">str_sort</span>(unsorted_latin)</span></code></pre></div>
<pre><code>## [1] &quot;♥&quot; &quot;I&quot; &quot;N&quot; &quot;Y&quot;</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="strings.html#cb62-1"></a><span class="kw">str_sort</span>(unsorted_latin, <span class="dt">locale =</span> <span class="st">&quot;lt&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;♥&quot; &quot;I&quot; &quot;Y&quot; &quot;N&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="strings.html#cb64-1"></a>unsorted_cyrillic &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;я&quot;</span>, <span class="st">&quot;i&quot;</span>, <span class="st">&quot;ж&quot;</span>)</span>
<span id="cb64-2"><a href="strings.html#cb64-2"></a><span class="kw">str_sort</span>(unsorted_cyrillic)</span></code></pre></div>
<pre><code>## [1] &quot;i&quot; &quot;ж&quot; &quot;я&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="strings.html#cb66-1"></a><span class="kw">str_sort</span>(unsorted_cyrillic, <span class="dt">locale =</span> <span class="st">&quot;ru_UA&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ж&quot; &quot;я&quot; &quot;i&quot;</code></pre>
<p>Список локалей на копмьютере можно посмотреть командой <code>stringi::stri_locale_list()</code>. Список всех локалей вообще приведен <a href="https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes">на этой странице</a>. Еще полезные команды: <code>stringi::stri_locale_info</code> и <code>stringi::stri_locale_set</code>.</p>
<p>Не углубляясь в <a href="https://www.youtube.com/watch?v=BeoCbJPuvSE">разнообразие алгоритмов сортировки</a>, отмечу, что алгоритм по-умолчанию хуже работает с большими данными:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="strings.html#cb68-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb68-2"><a href="strings.html#cb68-2"></a>huge &lt;-<span class="st"> </span><span class="kw">sample</span>(letters, <span class="fl">1e7</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb68-3"><a href="strings.html#cb68-3"></a><span class="kw">head</span>(huge)</span></code></pre></div>
<pre><code>## [1] &quot;q&quot; &quot;e&quot; &quot;a&quot; &quot;y&quot; &quot;j&quot; &quot;d&quot;</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="strings.html#cb70-1"></a><span class="kw">system.time</span>(</span>
<span id="cb70-2"><a href="strings.html#cb70-2"></a>  <span class="kw">sort</span>(huge)</span>
<span id="cb70-3"><a href="strings.html#cb70-3"></a>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   6.000   0.007   6.007</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="strings.html#cb72-1"></a><span class="kw">system.time</span>(</span>
<span id="cb72-2"><a href="strings.html#cb72-2"></a>  <span class="kw">sort</span>(huge, <span class="dt">method =</span> <span class="st">&quot;radix&quot;</span>)</span>
<span id="cb72-3"><a href="strings.html#cb72-3"></a>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   0.222   0.012   0.233</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="strings.html#cb74-1"></a><span class="kw">system.time</span>(</span>
<span id="cb74-2"><a href="strings.html#cb74-2"></a>  <span class="kw">str_sort</span>(huge)</span>
<span id="cb74-3"><a href="strings.html#cb74-3"></a>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   5.512   0.028   5.540</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="strings.html#cb76-1"></a>huge_tbl &lt;-<span class="st"> </span><span class="kw">tibble</span>(huge)</span>
<span id="cb76-2"><a href="strings.html#cb76-2"></a><span class="kw">system.time</span>(</span>
<span id="cb76-3"><a href="strings.html#cb76-3"></a>  huge_tbl <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-4"><a href="strings.html#cb76-4"></a><span class="st">    </span><span class="kw">arrange</span>(huge)</span>
<span id="cb76-5"><a href="strings.html#cb76-5"></a>)</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   2.894   0.020   2.913</code></pre>
<p>Предварительный вывод: для больших данных – <code>sort(..., method = "radix")</code>.</p>
</div>
<div id="поиск-подстроки" class="section level2">
<h2><span class="header-section-number">5.6</span> Поиск подстроки</h2>
<p>Можно использовать функцию <code>str_detect()</code>:</p>
<p><img src="images/5.04_str_detect.png" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="strings.html#cb78-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-2"><a href="strings.html#cb78-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">has_r =</span> <span class="kw">str_detect</span>(mn, <span class="st">&quot;r&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        has_r
##    &lt;chr&gt;     &lt;lgl&gt;
##  1 January   TRUE 
##  2 February  TRUE 
##  3 March     TRUE 
##  4 April     TRUE 
##  5 May       FALSE
##  6 June      FALSE
##  7 July      FALSE
##  8 August    FALSE
##  9 September TRUE 
## 10 October   TRUE 
## 11 November  TRUE 
## 12 December  TRUE</code></pre>
<p>Кроме того, существует функция, которая возвращает индексы, а не значения <code>TRUE</code>/<code>FALSE</code>:
<img src="images/5.05_str_which.png" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="strings.html#cb80-1"></a><span class="kw">str_which</span>(month.name, <span class="st">&quot;r&quot;</span>)</span></code></pre></div>
<pre><code>## [1]  1  2  3  4  9 10 11 12</code></pre>
<p>Также можно посчитать количество вхождений какой-то подстроки:</p>
<p><img src="images/5.06_str_count.png" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="strings.html#cb82-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb82-2"><a href="strings.html#cb82-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">has_r =</span> <span class="kw">str_count</span>(mn, <span class="st">&quot;r&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        has_r
##    &lt;chr&gt;     &lt;int&gt;
##  1 January       1
##  2 February      2
##  3 March         1
##  4 April         1
##  5 May           0
##  6 June          0
##  7 July          0
##  8 August        0
##  9 September     1
## 10 October       1
## 11 November      1
## 12 December      1</code></pre>
</div>
<div id="изменение-строк" class="section level2">
<h2><span class="header-section-number">5.7</span> Изменение строк</h2>
<div id="изменение-регистра" class="section level3">
<h3><span class="header-section-number">5.7.1</span> Изменение регистра</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="strings.html#cb84-1"></a>latin &lt;-<span class="st"> &quot;tHe QuIcK BrOwN fOx JuMpS OvEr ThE lAzY dOg&quot;</span></span>
<span id="cb84-2"><a href="strings.html#cb84-2"></a>cyrillic &lt;-<span class="st"> &quot;лЮбЯ, сЪеШь ЩиПцЫ, — вЗдОхНёТ мЭр, — кАйФ жГуЧ&quot;</span></span>
<span id="cb84-3"><a href="strings.html#cb84-3"></a><span class="kw">str_to_upper</span>(latin)</span></code></pre></div>
<pre><code>## [1] &quot;THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG&quot;</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="strings.html#cb86-1"></a><span class="kw">str_to_lower</span>(cyrillic)</span></code></pre></div>
<pre><code>## [1] &quot;любя, съешь щипцы, — вздохнёт мэр, — кайф жгуч&quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="strings.html#cb88-1"></a><span class="kw">str_to_title</span>(latin)</span></code></pre></div>
<pre><code>## [1] &quot;The Quick Brown Fox Jumps Over The Lazy Dog&quot;</code></pre>
</div>
<div id="выделение-подстроки" class="section level3">
<h3><span class="header-section-number">5.7.2</span> Выделение подстроки</h3>
<p>Подстроку в строке можно выделить двумя способами: по индексам функцией <code>str_sub()</code>, и по подстроке функцией <code>str_png()</code>.</p>
<p><img src="images/5.07_str_sub.png" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="strings.html#cb90-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb90-2"><a href="strings.html#cb90-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mutate =</span> <span class="kw">str_sub</span>(mn, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">end =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mutate
##    &lt;chr&gt;     &lt;chr&gt; 
##  1 January   Ja    
##  2 February  Fe    
##  3 March     Ma    
##  4 April     Ap    
##  5 May       Ma    
##  6 June      Ju    
##  7 July      Ju    
##  8 August    Au    
##  9 September Se    
## 10 October   Oc    
## 11 November  No    
## 12 December  De</code></pre>
<p><img src="images/5.08_str_extract.png" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="strings.html#cb92-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb92-2"><a href="strings.html#cb92-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mutate =</span> <span class="kw">str_extract</span>(mn, <span class="st">&quot;r&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mutate
##    &lt;chr&gt;     &lt;chr&gt; 
##  1 January   r     
##  2 February  r     
##  3 March     r     
##  4 April     r     
##  5 May       &lt;NA&gt;  
##  6 June      &lt;NA&gt;  
##  7 July      &lt;NA&gt;  
##  8 August    &lt;NA&gt;  
##  9 September r     
## 10 October   r     
## 11 November  r     
## 12 December  r</code></pre>
<p>По умолчанию функция <code>str_extract()</code> возвращает первое вхождение подстроки, соответствующей шаблону. Также существует функция <code>str_extract_all()</code>, которая возвращает все вхождения подстрок, соответствующих шаблону, однако возвращает объект типа список.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="strings.html#cb94-1"></a><span class="kw">str_extract_all</span>(month.name, <span class="st">&quot;r&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;r&quot;
## 
## [[2]]
## [1] &quot;r&quot; &quot;r&quot;
## 
## [[3]]
## [1] &quot;r&quot;
## 
## [[4]]
## [1] &quot;r&quot;
## 
## [[5]]
## character(0)
## 
## [[6]]
## character(0)
## 
## [[7]]
## character(0)
## 
## [[8]]
## character(0)
## 
## [[9]]
## [1] &quot;r&quot;
## 
## [[10]]
## [1] &quot;r&quot;
## 
## [[11]]
## [1] &quot;r&quot;
## 
## [[12]]
## [1] &quot;r&quot;</code></pre>
</div>
<div id="замена-подстроки" class="section level3">
<h3><span class="header-section-number">5.7.3</span> Замена подстроки</h3>
<p>Существует функция <code>str_replace()</code>, которая позволяет заменить одну подстроку в строке на другую:</p>
<p><img src="images/5.11_str_replace.png" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="strings.html#cb96-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb96-2"><a href="strings.html#cb96-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mutate =</span> <span class="kw">str_replace</span>(mn, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;R&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mutate   
##    &lt;chr&gt;     &lt;chr&gt;    
##  1 January   JanuaRy  
##  2 February  FebRuary 
##  3 March     MaRch    
##  4 April     ApRil    
##  5 May       May      
##  6 June      June     
##  7 July      July     
##  8 August    August   
##  9 September SeptembeR
## 10 October   OctobeR  
## 11 November  NovembeR 
## 12 December  DecembeR</code></pre>
<p>Как и другие функции <code>str_replace()</code> делает лишь одну замену, чтобы заменить все вхождения подстроки следует использовать функцию <code>str_replace_all()</code>:</p>
<p><img src="images/5.12_str_replace_all.png" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="strings.html#cb98-1"></a><span class="kw">tibble</span>(<span class="dt">mn =</span> month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb98-2"><a href="strings.html#cb98-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mutate =</span> <span class="kw">str_replace_all</span>(mn, <span class="st">&quot;r&quot;</span>, <span class="st">&quot;R&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    mn        mutate   
##    &lt;chr&gt;     &lt;chr&gt;    
##  1 January   JanuaRy  
##  2 February  FebRuaRy 
##  3 March     MaRch    
##  4 April     ApRil    
##  5 May       May      
##  6 June      June     
##  7 July      July     
##  8 August    August   
##  9 September SeptembeR
## 10 October   OctobeR  
## 11 November  NovembeR 
## 12 December  DecembeR</code></pre>
</div>
<div id="удаление-подстроки" class="section level3">
<h3><span class="header-section-number">5.7.4</span> Удаление подстроки</h3>
<p>Для удаления подстроки на основе шаблона, используется функция <code>str_remove()</code> и <code>str_remove_all()</code></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="strings.html#cb100-1"></a><span class="kw">tibble</span>(month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb100-2"><a href="strings.html#cb100-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mutate =</span> <span class="kw">str_remove</span>(month.name, <span class="st">&quot;r&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    month.name mutate  
##    &lt;chr&gt;      &lt;chr&gt;   
##  1 January    Januay  
##  2 February   Febuary 
##  3 March      Mach    
##  4 April      Apil    
##  5 May        May     
##  6 June       June    
##  7 July       July    
##  8 August     August  
##  9 September  Septembe
## 10 October    Octobe  
## 11 November   Novembe 
## 12 December   Decembe</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="strings.html#cb102-1"></a><span class="kw">tibble</span>(month.name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb102-2"><a href="strings.html#cb102-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mutate =</span> <span class="kw">str_remove_all</span>(month.name, <span class="st">&quot;r&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 12 x 2
##    month.name mutate  
##    &lt;chr&gt;      &lt;chr&gt;   
##  1 January    Januay  
##  2 February   Febuay  
##  3 March      Mach    
##  4 April      Apil    
##  5 May        May     
##  6 June       June    
##  7 July       July    
##  8 August     August  
##  9 September  Septembe
## 10 October    Octobe  
## 11 November   Novembe 
## 12 December   Decembe</code></pre>
</div>
<div id="транслитерация-строк" class="section level3">
<h3><span class="header-section-number">5.7.5</span> Транслитерация строк</h3>
<p>В пакете <code>stringi</code> сууществует достаточно много методов транслитераций строк, которые можно вывести командой <code>stri_trans_list()</code>. Вот пример использования некоторых из них:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="strings.html#cb104-1"></a><span class="kw">stri_trans_general</span>(<span class="st">&quot;stringi&quot;</span>, <span class="st">&quot;latin-cyrillic&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;стринги&quot;</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="strings.html#cb106-1"></a><span class="kw">stri_trans_general</span>(<span class="st">&quot;сырники&quot;</span>, <span class="st">&quot;cyrillic-latin&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;syrniki&quot;</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="strings.html#cb108-1"></a><span class="kw">stri_trans_general</span>(<span class="st">&quot;stringi&quot;</span>, <span class="st">&quot;latin-greek&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;στριγγι&quot;</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="strings.html#cb110-1"></a><span class="kw">stri_trans_general</span>(<span class="st">&quot;stringi&quot;</span>, <span class="st">&quot;latin-armenian&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ստրինգի&quot;</code></pre>
<div class="rmdtask">
<p>
Вот два датасета:
</p>
<ul>
<li>
<a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/cities_of_russia.csv">список городов России</a>
</li>
<li>
<a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/freq_dict_2011.csv">частотный словарь русского языка [Шаров, Ляшевская 2011]</a>
</li>
</ul>
<p>
Определите сколько городов называется обычным словом русского языка (например, город Орёл)? Не забудьте поменять ё на е.
</p>
</div>
<details>
<p><summary> 📋 список подсказок ➡ </summary></p>
<details>
<summary> 👁 Датасеты скачались, что дальше? ➡ </summary>
Надо их преобразовать к нужному виду и объединить. <br>
</details>
<details>
<summary> 👁 А как их соединить? Что у них общего? ➡ </summary><br />
В одном датасете есть переменная <code>city</code>, в другом – переменная <code>lemma</code>. Все города начинаются с большой буквы, все леммы с маленькой буквы. Я бы уменьшил букву в датасете с городами, сделал бы новый столбец в датасете с городами (например, <code>town</code>), соединил бы датасеты и посчитал бы сколько в результирующем датасете значений <code>town</code>.
<br>
</details>
<details>
<summary> 👁 А как соеднить? ➡ </summary>
Я бы использовал <code>dict %&gt;% ... %&gt;% left_join(cities)</code>. Если в датасетах разные названия столбцов, то следует указывать какие столбцы, каким соответствуют:<code>dict %&gt;% ... %&gt;% left_join(cities, by = c("lemma" = "city"))</code>
<br>
</details>
<details>
<summary> 👁 Соединилось вроде… А как посчитать? ➡ </summary>
Я бы, как обычно, использовал функцию <code>count()</code>.
<br>
</details>
</details>
</div>
</div>
<div id="регулярные-выражения" class="section level2">
<h2><span class="header-section-number">5.8</span> Регулярные выражения</h2>
</div>
<div id="определение-языка" class="section level2">
<h2><span class="header-section-number">5.9</span> Определение языка</h2>
<p>Для определения языка существует два пакета <code>cld2</code> (вероятностный) и <code>cld3</code> (нейросеть).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="strings.html#cb112-1"></a>udhr_<span class="dv">24</span> &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://goo.gl/cHviY5&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>, <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</span>
<span id="cb112-2"><a href="strings.html#cb112-2"></a>udhr_<span class="dv">24</span></span></code></pre></div>
<pre><code>##                                                                                                                                                     article_text
## 1                        Каждый человек имеет право на отдых и досуг, включая право на разумное ограничение рабочего дня и на оплачиваемый периодический отпуск.
## 2                                   Everyone has the right to rest and leisure, including reasonable limitation of working hours and periodic holidays with pay.
## 3             Toute personne a droit au repos et aux loisirs et notamment à une limitation raisonnable de la durée du travail et à des congés payés périodiques.
## 4 Toda persona tiene derecho al descanso, al disfrute del tiempo libre, a una limitación razonable de la duración del trabajo y a vacaciones periódicas pagadas.
## 5                                                                لكلِّ شخص حقٌّ في الراحة وأوقات الفراغ، وخصوصًا في تحديد معقول لساعات العمل وفي إجازات دورية مأجورة.
## 6                                                                                       人人有享有休息和闲暇的权利，包括工作时间有合理限制和定期给薪休假的权利。</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="strings.html#cb114-1"></a>cld2<span class="op">::</span><span class="kw">detect_language</span>(udhr_<span class="dv">24</span><span class="op">$</span>article_text)</span></code></pre></div>
<pre><code>## [1] &quot;ru&quot; &quot;en&quot; &quot;fr&quot; &quot;es&quot; &quot;ar&quot; &quot;zh&quot;</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="strings.html#cb116-1"></a>cld2<span class="op">::</span><span class="kw">detect_language</span>(udhr_<span class="dv">24</span><span class="op">$</span>article_text, <span class="dt">lang_code =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;RUSSIAN&quot; &quot;ENGLISH&quot; &quot;FRENCH&quot;  &quot;SPANISH&quot; &quot;ARABIC&quot;  &quot;CHINESE&quot;</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="strings.html#cb118-1"></a>cld3<span class="op">::</span><span class="kw">detect_language</span>(udhr_<span class="dv">24</span><span class="op">$</span>article_text)</span></code></pre></div>
<pre><code>## [1] &quot;ru&quot; &quot;en&quot; &quot;fr&quot; &quot;es&quot; &quot;ar&quot; &quot;zh&quot;</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="strings.html#cb120-1"></a>cld2<span class="op">::</span><span class="kw">detect_language</span>(<span class="st">&quot;Ты женат? Говорите ли по-английски?&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;bg&quot;</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="strings.html#cb122-1"></a>cld3<span class="op">::</span><span class="kw">detect_language</span>(<span class="st">&quot;Ты женат? Говорите ли по-английски?&quot;</span>)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="strings.html#cb124-1"></a>cld2<span class="op">::</span><span class="kw">detect_language</span>(<span class="st">&quot;Варкалось. Хливкие шорьки пырялись по наве, и хрюкотали зелюки, как мюмзики в мове.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ru&quot;</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="strings.html#cb126-1"></a>cld3<span class="op">::</span><span class="kw">detect_language</span>(<span class="st">&quot;Варкалось. Хливкие шорьки пырялись по наве, и хрюкотали зелюки, как мюмзики в мове.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;ru&quot;</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="strings.html#cb128-1"></a>cld2<span class="op">::</span><span class="kw">detect_language</span>(<span class="st">&quot;Варчилось… Хлив&#39;язкі тхурки викрули, свербчись навкрузі, жасумновілі худоки гривіли зехряки в чузі.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;uk&quot;</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="strings.html#cb130-1"></a>cld3<span class="op">::</span><span class="kw">detect_language</span>(<span class="st">&quot;Варчилось… Хлив&#39;язкі тхурки викрули, свербчись навкрузі, жасумновілі худоки гривіли зехряки в чузі.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;uk&quot;</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="strings.html#cb132-1"></a>cld2<span class="op">::</span><span class="kw">detect_language_mixed</span>(<span class="st">&quot;Многие в нашей команде OpenDataScience занимаются state-of-the-art технологиями машинного обучения: DL-фреймворками, байесовскими методами машинного обучения, вероятностным программированием и не только.&quot;</span>)</span></code></pre></div>
<pre><code>## $classificaton
##   language code latin proportion
## 1  RUSSIAN   ru FALSE       0.87
## 2  ENGLISH   en  TRUE       0.11
## 3  UNKNOWN   un  TRUE       0.00
## 
## $bytes
## [1] 353
## 
## $reliabale
## [1] TRUE</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="strings.html#cb134-1"></a>cld3<span class="op">::</span><span class="kw">detect_language_mixed</span>(<span class="st">&quot;Многие в нашей команде OpenDataScience занимаются state-of-the-art технологиями машинного обучения: DL-фреймворками, байесовскими методами машинного обучения, вероятностным программированием и не только.&quot;</span>)</span></code></pre></div>
<pre><code>##   language probability reliable proportion
## 1       ru   0.9983915     TRUE 0.88951844
## 2       en   0.9992564     TRUE 0.05099150
## 3       sr   0.4266235    FALSE 0.04815864</code></pre>
</div>
<div id="расстояния-между-строками" class="section level2">
<h2><span class="header-section-number">5.10</span> Расстояния между строками</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="viz-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-presentation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/agricolamz/DS_for_DH/edit/master/04-strings.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["DS_for_DH.pdf", "DS_for_DH.epub"],
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

</body>

</html>
