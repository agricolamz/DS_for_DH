<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований</title>
  <meta name="description" content="15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Корреляция и регрессия | Наука о данных в R для программы Цифровых гуманитарных исследований" />
  
  
  

<meta name="author" content="Г. А. Мороз, И. С. Поздняков" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="проверка-статистических-гипотез.html"/>
<link rel="next" href="работа-статистического-детектива.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="libs/Leaflet.Sync-0.0.5/L.Map.Sync.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Наука о данных в R для ЦГИ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Введение в R</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#наука-о-данных"><i class="fa fa-check"></i><b>2.1</b> Наука о данных</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>2.2</b> Установка R и RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#полезные-ссылки"><i class="fa fa-check"></i><b>2.3</b> Полезные ссылки</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.4</b> Rstudio</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#введение-в-r"><i class="fa fa-check"></i><b>2.5</b> Введение в R</a><ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#calc"><i class="fa fa-check"></i><b>2.5.1</b> R как калькулятор</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#func"><i class="fa fa-check"></i><b>2.5.2</b> Функции</a></li>
<li class="chapter" data-level="2.5.3" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>2.5.3</b> Переменные</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#data_types"><i class="fa fa-check"></i><b>2.6</b> Типы данных</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#atomic"><i class="fa fa-check"></i><b>2.7</b> Вектор</a><ul>
<li class="chapter" data-level="2.7.1" data-path="intro.html"><a href="intro.html#coercion"><i class="fa fa-check"></i><b>2.7.1</b> Coercion</a></li>
<li class="chapter" data-level="2.7.2" data-path="intro.html"><a href="intro.html#vector_op"><i class="fa fa-check"></i><b>2.7.2</b> Операции с векторами</a></li>
<li class="chapter" data-level="2.7.3" data-path="intro.html"><a href="intro.html#recycling"><i class="fa fa-check"></i><b>2.7.3</b> Recycling</a></li>
<li class="chapter" data-level="2.7.4" data-path="intro.html"><a href="intro.html#index_atomic"><i class="fa fa-check"></i><b>2.7.4</b> Индексирование векторов</a></li>
<li class="chapter" data-level="2.7.5" data-path="intro.html"><a href="intro.html#na"><i class="fa fa-check"></i><b>2.7.5</b> NA — пропущенные значения</a></li>
<li class="chapter" data-level="2.7.6" data-path="intro.html"><a href="intro.html#google"><i class="fa fa-check"></i><b>2.7.6</b> В любой непонятной ситуации — ищите в поисковике</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#matrix"><i class="fa fa-check"></i><b>2.8</b> Матрицы (matrix)</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#list"><i class="fa fa-check"></i><b>2.9</b> Списки (list)</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#df"><i class="fa fa-check"></i><b>2.10</b> Data.frame</a></li>
<li class="chapter" data-level="2.11" data-path="intro.html"><a href="intro.html#real_data"><i class="fa fa-check"></i><b>2.11</b> Начинаем работу с реальными данными</a><ul>
<li class="chapter" data-level="2.11.1" data-path="intro.html"><a href="intro.html#wd"><i class="fa fa-check"></i><b>2.11.1</b> Рабочая папка и проекты</a></li>
<li class="chapter" data-level="2.11.2" data-path="intro.html"><a href="intro.html#import"><i class="fa fa-check"></i><b>2.11.2</b> Импорт данных</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="intro.html"><a href="intro.html#prep"><i class="fa fa-check"></i><b>2.12</b> Препроцессинг данных в R</a><ul>
<li class="chapter" data-level="2.12.1" data-path="intro.html"><a href="intro.html#explore"><i class="fa fa-check"></i><b>2.12.1</b> Исследование данных</a></li>
<li class="chapter" data-level="2.12.2" data-path="intro.html"><a href="intro.html#subset"><i class="fa fa-check"></i><b>2.12.2</b> Subsetting</a></li>
<li class="chapter" data-level="2.12.3" data-path="intro.html"><a href="intro.html#newcol"><i class="fa fa-check"></i><b>2.12.3</b> Создание новых колонок</a></li>
<li class="chapter" data-level="2.12.4" data-path="intro.html"><a href="intro.html#dtvstidy"><i class="fa fa-check"></i><b>2.12.4</b> data.table vs. tidyverse</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html"><i class="fa fa-check"></i><b>3</b> <code>tidyverse</code>: Загрузка и трансформация данных</a><ul>
<li class="chapter" data-level="3.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#загрузка-данных"><i class="fa fa-check"></i><b>3.1</b> Загрузка данных</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#рабочая-директория"><i class="fa fa-check"></i><b>3.1.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="3.1.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#форматы-данных-.csv"><i class="fa fa-check"></i><b>3.1.2</b> Форматы данных: <code>.csv</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#загрузка-данных-readr-readxl"><i class="fa fa-check"></i><b>3.1.3</b> Загрузка данных: readr, readxl</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#tibble"><i class="fa fa-check"></i><b>3.2</b> <code>tibble</code></a></li>
<li class="chapter" data-level="3.3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyr"><i class="fa fa-check"></i><b>3.3</b> <code>dplyr</code></a><ul>
<li class="chapter" data-level="3.3.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrfilter"><i class="fa fa-check"></i><b>3.3.1</b> <code>dplyr::filter()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrslice"><i class="fa fa-check"></i><b>3.3.2</b> <code>dplyr::slice()</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrselect"><i class="fa fa-check"></i><b>3.3.3</b> <code>dplyr::select()</code></a></li>
<li class="chapter" data-level="3.3.4" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrarrange"><i class="fa fa-check"></i><b>3.3.4</b> <code>dplyr::arrange()</code></a></li>
<li class="chapter" data-level="3.3.5" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrdistinct"><i class="fa fa-check"></i><b>3.3.5</b> <code>dplyr::distinct()</code></a></li>
<li class="chapter" data-level="3.3.6" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrmutate"><i class="fa fa-check"></i><b>3.3.6</b> <code>dplyr::mutate()</code></a></li>
<li class="chapter" data-level="3.3.7" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyrgroup_by...-summarise..."><i class="fa fa-check"></i><b>3.3.7</b> <code>dplyr::group_by(...) %&gt;% summarise(...)</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#соединение-датафреймов"><i class="fa fa-check"></i><b>3.4</b> Соединение датафреймов</a><ul>
<li class="chapter" data-level="3.4.1" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#bind_..."><i class="fa fa-check"></i><b>3.4.1</b> <code>bind_...</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#dplyr.._join"><i class="fa fa-check"></i><b>3.4.2</b> <code>dplyr::.._join()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#tidyr-package"><i class="fa fa-check"></i><b>3.5</b> <code>tidyr</code> package</a></li>
<li class="chapter" data-level="3.6" data-path="tidy-dplyr.html"><a href="tidy-dplyr.html#полезные-надстройки"><i class="fa fa-check"></i><b>3.6</b> Полезные надстройки</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="viz-1.html"><a href="viz-1.html"><i class="fa fa-check"></i><b>4</b> Визуализация данных</a><ul>
<li class="chapter" data-level="4.1" data-path="viz-1.html"><a href="viz-1.html#зачем-визуализировать-данные"><i class="fa fa-check"></i><b>4.1</b> Зачем визуализировать данные?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="viz-1.html"><a href="viz-1.html#квартет-анскомба"><i class="fa fa-check"></i><b>4.1.1</b> Квартет Анскомба</a></li>
<li class="chapter" data-level="4.1.2" data-path="viz-1.html"><a href="viz-1.html#датазаурус"><i class="fa fa-check"></i><b>4.1.2</b> Датазаурус</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="viz-1.html"><a href="viz-1.html#основы-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Основы <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.2.1" data-path="viz-1.html"><a href="viz-1.html#диаграмма-рассеяния-scaterplot"><i class="fa fa-check"></i><b>4.2.1</b> Диаграмма рассеяния (Scaterplot)</a></li>
<li class="chapter" data-level="4.2.2" data-path="viz-1.html"><a href="viz-1.html#слои"><i class="fa fa-check"></i><b>4.2.2</b> Слои</a></li>
<li class="chapter" data-level="4.2.3" data-path="viz-1.html"><a href="viz-1.html#aes"><i class="fa fa-check"></i><b>4.2.3</b> <code>aes()</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="viz-1.html"><a href="viz-1.html#оформление"><i class="fa fa-check"></i><b>4.2.4</b> Оформление</a></li>
<li class="chapter" data-level="4.2.5" data-path="viz-1.html"><a href="viz-1.html#логарифмические-шкалы"><i class="fa fa-check"></i><b>4.2.5</b> Логарифмические шкалы</a></li>
<li class="chapter" data-level="4.2.6" data-path="viz-1.html"><a href="viz-1.html#annotate"><i class="fa fa-check"></i><b>4.2.6</b> <code>annotate()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="viz-1.html"><a href="viz-1.html#столбчатые-диаграммы-barplots"><i class="fa fa-check"></i><b>4.3</b> Столбчатые диаграммы (barplots)</a></li>
<li class="chapter" data-level="4.4" data-path="viz-1.html"><a href="viz-1.html#факторы"><i class="fa fa-check"></i><b>4.4</b> Факторы</a></li>
<li class="chapter" data-level="4.5" data-path="viz-1.html"><a href="viz-1.html#дотплот"><i class="fa fa-check"></i><b>4.5</b> Дотплот</a></li>
<li class="chapter" data-level="4.6" data-path="viz-1.html"><a href="viz-1.html#гистограммы"><i class="fa fa-check"></i><b>4.6</b> Гистограммы</a></li>
<li class="chapter" data-level="4.7" data-path="viz-1.html"><a href="viz-1.html#функции-плотности"><i class="fa fa-check"></i><b>4.7</b> Функции плотности</a></li>
<li class="chapter" data-level="4.8" data-path="viz-1.html"><a href="viz-1.html#точки-джиттер-jitter-вайолинплот-violinplot-ящики-с-усами-boxplot"><i class="fa fa-check"></i><b>4.8</b> Точки, джиттер (jitter), вайолинплот (violinplot), ящики с усами (boxplot),</a></li>
<li class="chapter" data-level="4.9" data-path="viz-1.html"><a href="viz-1.html#фасетизация"><i class="fa fa-check"></i><b>4.9</b> Фасетизация</a></li>
<li class="chapter" data-level="4.10" data-path="viz-1.html"><a href="viz-1.html#визуализация-комбинаций-признаков"><i class="fa fa-check"></i><b>4.10</b> Визуализация комбинаций признаков</a><ul>
<li class="chapter" data-level="4.10.1" data-path="viz-1.html"><a href="viz-1.html#потоковая-диаграмма-sankey-diagram"><i class="fa fa-check"></i><b>4.10.1</b> Потоковая Диаграмма (Sankey diagram)</a></li>
<li class="chapter" data-level="4.10.2" data-path="viz-1.html"><a href="viz-1.html#upset-plot"><i class="fa fa-check"></i><b>4.10.2</b> UpSet Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>5</b> Работа со строками</a><ul>
<li class="chapter" data-level="5.1" data-path="strings.html"><a href="strings.html#работа-со-строками-в-r"><i class="fa fa-check"></i><b>5.1</b> Работа со строками в R</a></li>
<li class="chapter" data-level="5.2" data-path="strings.html"><a href="strings.html#как-получить-строку"><i class="fa fa-check"></i><b>5.2</b> Как получить строку?</a></li>
<li class="chapter" data-level="5.3" data-path="strings.html"><a href="strings.html#соединение-и-разделение-строк"><i class="fa fa-check"></i><b>5.3</b> Соединение и разделение строк</a></li>
<li class="chapter" data-level="5.4" data-path="strings.html"><a href="strings.html#количество-символов"><i class="fa fa-check"></i><b>5.4</b> Количество символов</a><ul>
<li class="chapter" data-level="5.4.1" data-path="strings.html"><a href="strings.html#подсчет-количества-символов"><i class="fa fa-check"></i><b>5.4.1</b> Подсчет количества символов</a></li>
<li class="chapter" data-level="5.4.2" data-path="strings.html"><a href="strings.html#подгонка-количества-символов"><i class="fa fa-check"></i><b>5.4.2</b> Подгонка количества символов</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="strings.html"><a href="strings.html#сортировка"><i class="fa fa-check"></i><b>5.5</b> Сортировка</a></li>
<li class="chapter" data-level="5.6" data-path="strings.html"><a href="strings.html#поиск-подстроки"><i class="fa fa-check"></i><b>5.6</b> Поиск подстроки</a></li>
<li class="chapter" data-level="5.7" data-path="strings.html"><a href="strings.html#изменение-строк"><i class="fa fa-check"></i><b>5.7</b> Изменение строк</a><ul>
<li class="chapter" data-level="5.7.1" data-path="strings.html"><a href="strings.html#изменение-регистра"><i class="fa fa-check"></i><b>5.7.1</b> Изменение регистра</a></li>
<li class="chapter" data-level="5.7.2" data-path="strings.html"><a href="strings.html#выделение-подстроки"><i class="fa fa-check"></i><b>5.7.2</b> Выделение подстроки</a></li>
<li class="chapter" data-level="5.7.3" data-path="strings.html"><a href="strings.html#замена-подстроки"><i class="fa fa-check"></i><b>5.7.3</b> Замена подстроки</a></li>
<li class="chapter" data-level="5.7.4" data-path="strings.html"><a href="strings.html#удаление-подстроки"><i class="fa fa-check"></i><b>5.7.4</b> Удаление подстроки</a></li>
<li class="chapter" data-level="5.7.5" data-path="strings.html"><a href="strings.html#транслитерация-строк"><i class="fa fa-check"></i><b>5.7.5</b> Транслитерация строк</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="strings.html"><a href="strings.html#регулярные-выражения"><i class="fa fa-check"></i><b>5.8</b> Регулярные выражения</a><ul>
<li class="chapter" data-level="5.8.1" data-path="strings.html"><a href="strings.html#экранирование-метасимволов"><i class="fa fa-check"></i><b>5.8.1</b> Экранирование метасимволов</a></li>
<li class="chapter" data-level="5.8.2" data-path="strings.html"><a href="strings.html#классы-знаков"><i class="fa fa-check"></i><b>5.8.2</b> Классы знаков</a></li>
<li class="chapter" data-level="5.8.3" data-path="strings.html"><a href="strings.html#квантификация"><i class="fa fa-check"></i><b>5.8.3</b> Квантификация</a></li>
<li class="chapter" data-level="5.8.4" data-path="strings.html"><a href="strings.html#позиционная-проверка-look-arounds"><i class="fa fa-check"></i><b>5.8.4</b> Позиционная проверка (look arounds)</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="strings.html"><a href="strings.html#определение-языка"><i class="fa fa-check"></i><b>5.9</b> Определение языка</a></li>
<li class="chapter" data-level="5.10" data-path="strings.html"><a href="strings.html#расстояния-между-строками"><i class="fa fa-check"></i><b>5.10</b> Расстояния между строками</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lists.html"><a href="lists.html"><i class="fa fa-check"></i><b>6</b> Работа со списками</a><ul>
<li class="chapter" data-level="6.1" data-path="lists.html"><a href="lists.html#что-такое-списки"><i class="fa fa-check"></i><b>6.1</b> Что такое списки?</a><ul>
<li class="chapter" data-level="6.1.1" data-path="lists.html"><a href="lists.html#превращение-json-в-список-и-обратно"><i class="fa fa-check"></i><b>6.1.1</b> Превращение JSON в список и обратно</a></li>
<li class="chapter" data-level="6.1.2" data-path="lists.html"><a href="lists.html#превращение-.xml-в-список-и-обратно"><i class="fa fa-check"></i><b>6.1.2</b> Превращение <code>.xml</code> в список и обратно</a></li>
<li class="chapter" data-level="6.1.3" data-path="lists.html"><a href="lists.html#просмотр-списков-в-r"><i class="fa fa-check"></i><b>6.1.3</b> Просмотр списков в R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="lists.html"><a href="lists.html#пакет-purrr"><i class="fa fa-check"></i><b>6.2</b> Пакет <code>purrr</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="lists.html"><a href="lists.html#функция-map-и-map..."><i class="fa fa-check"></i><b>6.2.1</b> Функция <code>map()</code> и <code>map...()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="lists.html"><a href="lists.html#фильтрация-списков"><i class="fa fa-check"></i><b>6.2.2</b> Фильтрация списков</a></li>
<li class="chapter" data-level="6.2.3" data-path="lists.html"><a href="lists.html#операции-со-списками"><i class="fa fa-check"></i><b>6.2.3</b> Операции со списками</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-presentation.html"><a href="data-presentation.html"><i class="fa fa-check"></i><b>7</b> Представление данных: <code>rmarkdown</code></a><ul>
<li class="chapter" data-level="7.1" data-path="data-presentation.html"><a href="data-presentation.html#rmarkdown"><i class="fa fa-check"></i><b>7.1</b> <code>rmarkdown</code></a><ul>
<li class="chapter" data-level="7.1.1" data-path="data-presentation.html"><a href="data-presentation.html#установка"><i class="fa fa-check"></i><b>7.1.1</b> Установка</a></li>
<li class="chapter" data-level="7.1.2" data-path="data-presentation.html"><a href="data-presentation.html#составляющие-rmarkdown-документа"><i class="fa fa-check"></i><b>7.1.2</b> Составляющие <code>rmarkdown</code>-документа</a></li>
<li class="chapter" data-level="7.1.3" data-path="data-presentation.html"><a href="data-presentation.html#пример-rmarkdown-документа"><i class="fa fa-check"></i><b>7.1.3</b> Пример <code>rmarkdown</code>-документа</a></li>
<li class="chapter" data-level="7.1.4" data-path="data-presentation.html"><a href="data-presentation.html#markdown"><i class="fa fa-check"></i><b>7.1.4</b> <code>Markdown</code></a></li>
<li class="chapter" data-level="7.1.5" data-path="data-presentation.html"><a href="data-presentation.html#pandoc"><i class="fa fa-check"></i><b>7.1.5</b> <code>Pandoc</code></a></li>
<li class="chapter" data-level="7.1.6" data-path="data-presentation.html"><a href="data-presentation.html#code-chunks"><i class="fa fa-check"></i><b>7.1.6</b> Code chunks</a></li>
<li class="chapter" data-level="7.1.7" data-path="data-presentation.html"><a href="data-presentation.html#yaml-шапка"><i class="fa fa-check"></i><b>7.1.7</b> YAML шапка</a></li>
<li class="chapter" data-level="7.1.8" data-path="data-presentation.html"><a href="data-presentation.html#где-хостить-.html"><i class="fa fa-check"></i><b>7.1.8</b> Где хостить <code>.html</code>?</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="data-presentation.html"><a href="data-presentation.html#бывают-и-другие-способы-представления-данных"><i class="fa fa-check"></i><b>7.2</b> Бывают и другие способы представления данных</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>8</b> Собственные функции и использование их в <code>tidyverse</code></a><ul>
<li class="chapter" data-level="8.1" data-path="functions.html"><a href="functions.html#напоминание-логические-операции"><i class="fa fa-check"></i><b>8.1</b> Напоминание: логические операции</a></li>
<li class="chapter" data-level="8.2" data-path="functions.html"><a href="functions.html#создание-собственных-функций"><i class="fa fa-check"></i><b>8.2</b> Создание собственных функций</a></li>
<li class="chapter" data-level="8.3" data-path="functions.html"><a href="functions.html#использование-условий-в-tidyverse"><i class="fa fa-check"></i><b>8.3</b> Использование условий в tidyverse</a><ul>
<li class="chapter" data-level="8.3.1" data-path="functions.html"><a href="functions.html#условия-в-строчках"><i class="fa fa-check"></i><b>8.3.1</b> Условия в строчках</a></li>
<li class="chapter" data-level="8.3.2" data-path="functions.html"><a href="functions.html#условия-в-столбцах"><i class="fa fa-check"></i><b>8.3.2</b> Условия в столбцах</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="functions.html"><a href="functions.html#reinvent-the-map-function"><i class="fa fa-check"></i><b>8.4</b> Reinvent the <code>map</code> function</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tidytext.html"><a href="tidytext.html"><i class="fa fa-check"></i><b>9</b> Работа с текстами: <code>gutenbergr</code>, <code>tidytext</code>, <code>stopwords</code>, <code>udpipe</code></a><ul>
<li class="chapter" data-level="9.1" data-path="tidytext.html"><a href="tidytext.html#загрузка-текста-в-r"><i class="fa fa-check"></i><b>9.1</b> Загрузка текста в R</a></li>
<li class="chapter" data-level="9.2" data-path="tidytext.html"><a href="tidytext.html#пакет-gutenbergr"><i class="fa fa-check"></i><b>9.2</b> Пакет <code>gutenbergr</code></a></li>
<li class="chapter" data-level="9.3" data-path="tidytext.html"><a href="tidytext.html#библиотека-tidytext"><i class="fa fa-check"></i><b>9.3</b> Библиотека <code>tidytext</code></a></li>
<li class="chapter" data-level="9.4" data-path="tidytext.html"><a href="tidytext.html#пакет-stopwords"><i class="fa fa-check"></i><b>9.4</b> Пакет <code>stopwords</code></a></li>
<li class="chapter" data-level="9.5" data-path="tidytext.html"><a href="tidytext.html#пакет-udpipe"><i class="fa fa-check"></i><b>9.5</b> Пакет <code>udpipe</code></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html"><i class="fa fa-check"></i><b>10</b> Работа с геоданными: <code>leaflet</code></a><ul>
<li class="chapter" data-level="10.1" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#векторная-и-растровая-графика"><i class="fa fa-check"></i><b>10.1</b> Векторная и растровая графика</a></li>
<li class="chapter" data-level="10.2" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#картографические-примитивы"><i class="fa fa-check"></i><b>10.2</b> Картографические примитивы</a></li>
<li class="chapter" data-level="10.3" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#leaflet"><i class="fa fa-check"></i><b>10.3</b> <code>leaflet</code></a><ul>
<li class="chapter" data-level="10.3.1" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#csv-файлы"><i class="fa fa-check"></i><b>10.3.1</b> <code>.csv</code> файлы</a></li>
<li class="chapter" data-level="10.3.2" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#комбинация-карт-leafsync"><i class="fa fa-check"></i><b>10.3.2</b> Комбинация карт: <code>leafsync</code></a></li>
<li class="chapter" data-level="10.3.3" data-path="работа-с-геоданными-leaflet.html"><a href="работа-с-геоданными-leaflet.html#работа-с-.geojson"><i class="fa fa-check"></i><b>10.3.3</b> Работа с <code>.geojson</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html"><i class="fa fa-check"></i><b>11</b> Работа со временем: <code>lubridate</code></a><ul>
<li class="chapter" data-level="11.1" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#создание-даты"><i class="fa fa-check"></i><b>11.1</b> Создание даты</a></li>
<li class="chapter" data-level="11.2" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#извлечение-компонентов-даты"><i class="fa fa-check"></i><b>11.2</b> Извлечение компонентов даты</a></li>
<li class="chapter" data-level="11.3" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#операции-с-датами"><i class="fa fa-check"></i><b>11.3</b> Операции с датами</a></li>
<li class="chapter" data-level="11.4" data-path="работа-со-временем-lubridate.html"><a href="работа-со-временем-lubridate.html#визуализация-времени-данные-левада-центра"><i class="fa fa-check"></i><b>11.4</b> Визуализация времени: данные Левада-центра</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html"><i class="fa fa-check"></i><b>12</b> Сбор данных из интернета: <code>rvest</code></a><ul>
<li class="chapter" data-level="12.1" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#введение"><i class="fa fa-check"></i><b>12.1</b> Введение</a></li>
<li class="chapter" data-level="12.2" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#работа-с-пакетом-rvest"><i class="fa fa-check"></i><b>12.2</b> Работа с пакетом <code>rvest</code></a><ul>
<li class="chapter" data-level="12.2.1" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#простой-случай"><i class="fa fa-check"></i><b>12.2.1</b> Простой случай</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#использование-атрибута-class"><i class="fa fa-check"></i><b>12.3</b> Использование атрибута <code>class</code></a><ul>
<li class="chapter" data-level="12.3.1" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#чтение-таблиц"><i class="fa fa-check"></i><b>12.3.1</b> Чтение таблиц</a></li>
<li class="chapter" data-level="12.3.2" data-path="сбор-данных-из-интернета-rvest.html"><a href="сбор-данных-из-интернета-rvest.html#некоторые-советы"><i class="fa fa-check"></i><b>12.3.2</b> Некоторые советы</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html"><i class="fa fa-check"></i><b>13</b> Описательная статистика, распределения</a><ul>
<li class="chapter" data-level="13.1" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#описательная-статистика"><i class="fa fa-check"></i><b>13.1</b> Описательная статистика</a><ul>
<li class="chapter" data-level="13.1.1" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#категориальные-переменные"><i class="fa fa-check"></i><b>13.1.1</b> Категориальные переменные</a></li>
<li class="chapter" data-level="13.1.2" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#числовые-переменные"><i class="fa fa-check"></i><b>13.1.2</b> Числовые переменные</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#от-частотности-к-вероятности"><i class="fa fa-check"></i><b>13.2</b> От частотности к вероятности</a><ul>
<li class="chapter" data-level="13.2.1" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#категориальная-переменная"><i class="fa fa-check"></i><b>13.2.1</b> Категориальная переменная</a></li>
<li class="chapter" data-level="13.2.2" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#числовая-переменная"><i class="fa fa-check"></i><b>13.2.2</b> Числовая переменная</a></li>
<li class="chapter" data-level="13.2.3" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#распределения"><i class="fa fa-check"></i><b>13.2.3</b> Распределения</a></li>
<li class="chapter" data-level="13.2.4" data-path="описательная-статистика-распределения.html"><a href="описательная-статистика-распределения.html#давайте-посчитаем-вероятности"><i class="fa fa-check"></i><b>13.2.4</b> Давайте посчитаем вероятности</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html"><i class="fa fa-check"></i><b>14</b> Проверка статистических гипотез</a><ul>
<li class="chapter" data-level="14.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#о-статистике"><i class="fa fa-check"></i><b>14.1</b> О статистике</a></li>
<li class="chapter" data-level="14.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#проверка-нулевой-гипотезы"><i class="fa fa-check"></i><b>14.2</b> Проверка нулевой гипотезы</a></li>
<li class="chapter" data-level="14.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#классификация-статистических-тестов"><i class="fa fa-check"></i><b>14.3</b> Классификация статистических тестов</a><ul>
<li class="chapter" data-level="14.3.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#количество-выборок"><i class="fa fa-check"></i><b>14.3.1</b> Количество выборок</a></li>
<li class="chapter" data-level="14.3.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#направление"><i class="fa fa-check"></i><b>14.3.2</b> Направление</a></li>
<li class="chapter" data-level="14.3.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#парные-vs.-непарные"><i class="fa fa-check"></i><b>14.3.3</b> Парные vs. непарные</a></li>
<li class="chapter" data-level="14.3.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#параметрические-vs.-непараметрические"><i class="fa fa-check"></i><b>14.3.4</b> Параметрические vs. непараметрические</a></li>
<li class="chapter" data-level="14.3.5" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#классификация-тестов"><i class="fa fa-check"></i><b>14.3.5</b> Классификация тестов</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#одновыборочные-тесты"><i class="fa fa-check"></i><b>14.4</b> Одновыборочные тесты</a><ul>
<li class="chapter" data-level="14.4.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#биномиальный-тест"><i class="fa fa-check"></i><b>14.4.1</b> Биномиальный тест</a></li>
<li class="chapter" data-level="14.4.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#одновыборочный-t-тест"><i class="fa fa-check"></i><b>14.4.2</b> Одновыборочный t-тест</a></li>
<li class="chapter" data-level="14.4.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#тест-уилкоксона"><i class="fa fa-check"></i><b>14.4.3</b> Тест Уилкоксона</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#двухвыборочные-тесты"><i class="fa fa-check"></i><b>14.5</b> Двухвыборочные тесты</a><ul>
<li class="chapter" data-level="14.5.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#двухвыборочный-t-тест"><i class="fa fa-check"></i><b>14.5.1</b> Двухвыборочный t-тест</a></li>
<li class="chapter" data-level="14.5.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#двухвыборочный-парный-t-тест"><i class="fa fa-check"></i><b>14.5.2</b> Двухвыборочный парный t-тест</a></li>
<li class="chapter" data-level="14.5.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#критерий-манна-уитни"><i class="fa fa-check"></i><b>14.5.3</b> Критерий Манна-Уитни</a></li>
<li class="chapter" data-level="14.5.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#критерий-χ²-тест-фишера"><i class="fa fa-check"></i><b>14.5.4</b> Критерий χ², тест Фишера</a></li>
<li class="chapter" data-level="14.5.5" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#критерий-мак-немара"><i class="fa fa-check"></i><b>14.5.5</b> Критерий Мак Немара</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#послесловие"><i class="fa fa-check"></i><b>14.6</b> Послесловие</a></li>
<li class="chapter" data-level="14.7" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#рассказы-чехова-и-зощенко"><i class="fa fa-check"></i><b>14.7</b> Рассказы Чехова и Зощенко</a><ul>
<li class="chapter" data-level="14.7.1" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section"><i class="fa fa-check"></i><b>14.7.1</b> </a></li>
<li class="chapter" data-level="14.7.2" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section-1"><i class="fa fa-check"></i><b>14.7.2</b> </a></li>
<li class="chapter" data-level="14.7.3" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section-2"><i class="fa fa-check"></i><b>14.7.3</b> </a></li>
<li class="chapter" data-level="14.7.4" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#section-3"><i class="fa fa-check"></i><b>14.7.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="проверка-статистических-гипотез.html"><a href="проверка-статистических-гипотез.html#obamacare"><i class="fa fa-check"></i><b>14.8</b> Obamacare</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html"><i class="fa fa-check"></i><b>15</b> Корреляция и регрессия</a><ul>
<li class="chapter" data-level="15.1" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#дисперсия-и-стандартное-отклонение"><i class="fa fa-check"></i><b>15.1</b> Дисперсия и стандартное отклонение</a></li>
<li class="chapter" data-level="15.2" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#z-преобразование"><i class="fa fa-check"></i><b>15.2</b> z-преобразование</a></li>
<li class="chapter" data-level="15.3" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#ковариация"><i class="fa fa-check"></i><b>15.3</b> Ковариация</a></li>
<li class="chapter" data-level="15.4" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#корреляция"><i class="fa fa-check"></i><b>15.4</b> Корреляция</a><ul>
<li class="chapter" data-level="15.4.1" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#корреляция-пирсона"><i class="fa fa-check"></i><b>15.4.1</b> Корреляция Пирсона</a></li>
<li class="chapter" data-level="15.4.2" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#ранговые-корреляции-спирмана-и-кендалла"><i class="fa fa-check"></i><b>15.4.2</b> Ранговые корреляции Спирмана и Кендалла</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#регрессионный-анализ"><i class="fa fa-check"></i><b>15.5</b> Регрессионный анализ</a><ul>
<li class="chapter" data-level="15.5.1" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#основы"><i class="fa fa-check"></i><b>15.5.1</b> Основы</a></li>
<li class="chapter" data-level="15.5.2" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#первая-регрессия"><i class="fa fa-check"></i><b>15.5.2</b> Первая регрессия</a></li>
<li class="chapter" data-level="15.5.3" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#категориальные-переменные-1"><i class="fa fa-check"></i><b>15.5.3</b> Категориальные переменные</a></li>
<li class="chapter" data-level="15.5.4" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#множественная-регрессия"><i class="fa fa-check"></i><b>15.5.4</b> Множественная регрессия</a></li>
<li class="chapter" data-level="15.5.5" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#сравнение-моделей"><i class="fa fa-check"></i><b>15.5.5</b> Сравнение моделей</a></li>
<li class="chapter" data-level="15.5.6" data-path="корреляция-и-регрессия.html"><a href="корреляция-и-регрессия.html#послесловие-1"><i class="fa fa-check"></i><b>15.5.6</b> Послесловие</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html"><i class="fa fa-check"></i><b>16</b> Работа статистического детектива</a><ul>
<li class="chapter" data-level="16.1" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#введение-1"><i class="fa fa-check"></i><b>16.1</b> Введение</a></li>
<li class="chapter" data-level="16.2" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#возможно-ли-такое-среднее"><i class="fa fa-check"></i><b>16.2</b> Возможно ли такое среднее?</a></li>
<li class="chapter" data-level="16.3" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#пакет-statcheck"><i class="fa fa-check"></i><b>16.3</b> Пакет <code>statcheck</code></a></li>
<li class="chapter" data-level="16.4" data-path="работа-статистического-детектива.html"><a href="работа-статистического-детектива.html#пакет-digitize"><i class="fa fa-check"></i><b>16.4</b> Пакет <code>digitize</code></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="кластеризация.html"><a href="кластеризация.html"><i class="fa fa-check"></i><b>17</b> Кластеризация</a><ul>
<li class="chapter" data-level="17.1" data-path="кластеризация.html"><a href="кластеризация.html#метод-k-средних-k-means"><i class="fa fa-check"></i><b>17.1</b> Метод k-средних (k-means)</a><ul>
<li class="chapter" data-level="17.1.1" data-path="кластеризация.html"><a href="кластеризация.html#пример"><i class="fa fa-check"></i><b>17.1.1</b> Пример</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="кластеризация.html"><a href="кластеризация.html#иерархическая-кластеризация"><i class="fa fa-check"></i><b>17.2</b> Иерархическая кластеризация</a><ul>
<li class="chapter" data-level="17.2.1" data-path="кластеризация.html"><a href="кластеризация.html#матрица-расстояний"><i class="fa fa-check"></i><b>17.2.1</b> Матрица расстояний</a></li>
<li class="chapter" data-level="17.2.2" data-path="кластеризация.html"><a href="кластеризация.html#расстояние-между-словами"><i class="fa fa-check"></i><b>17.2.2</b> Расстояние между словами</a></li>
<li class="chapter" data-level="17.2.3" data-path="кластеризация.html"><a href="кластеризация.html#применение-иерархической-кластеризации"><i class="fa fa-check"></i><b>17.2.3</b> Применение иерархической кластеризации</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="методы-уменьшения-размерностей.html"><a href="методы-уменьшения-размерностей.html"><i class="fa fa-check"></i><b>18</b> Методы уменьшения размерностей</a><ul>
<li class="chapter" data-level="18.1" data-path="методы-уменьшения-размерностей.html"><a href="методы-уменьшения-размерностей.html#визуализация-многомерных-пространств"><i class="fa fa-check"></i><b>18.1</b> Визуализация многомерных пространств</a></li>
<li class="chapter" data-level="18.2" data-path="методы-уменьшения-размерностей.html"><a href="методы-уменьшения-размерностей.html#простой-пример-из-двумерного-пространства-в-одномерное-пространство"><i class="fa fa-check"></i><b>18.2</b> Простой пример: из двумерного пространства в одномерное пространство</a></li>
<li class="chapter" data-level="18.3" data-path="методы-уменьшения-размерностей.html"><a href="методы-уменьшения-размерностей.html#многомерное-шкалирование-mds"><i class="fa fa-check"></i><b>18.3</b> Многомерное шкалирование (MDS)</a></li>
<li class="chapter" data-level="18.4" data-path="методы-уменьшения-размерностей.html"><a href="методы-уменьшения-размерностей.html#метод-главных-компонент-pca"><i class="fa fa-check"></i><b>18.4</b> Метод главных компонент (PCA)</a></li>
<li class="chapter" data-level="18.5" data-path="методы-уменьшения-размерностей.html"><a href="методы-уменьшения-размерностей.html#множественный-анализ-соответствий"><i class="fa fa-check"></i><b>18.5</b> Множественный анализ соответствий</a></li>
<li class="chapter" data-level="18.6" data-path="методы-уменьшения-размерностей.html"><a href="методы-уменьшения-размерностей.html#другие-методы-уменьшения-размерности"><i class="fa fa-check"></i><b>18.6</b> Другие методы уменьшения размерности</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="tasks.html"><a href="tasks.html"><i class="fa fa-check"></i><b>19</b> Задания</a><ul>
<li class="chapter" data-level="19.1" data-path="tasks.html"><a href="tasks.html#vec_task_1"><i class="fa fa-check"></i><b>19.1</b> Вектор</a></li>
<li class="chapter" data-level="19.2" data-path="tasks.html"><a href="tasks.html#vec_op"><i class="fa fa-check"></i><b>19.2</b> Вектор. Операции с векторами</a></li>
<li class="chapter" data-level="19.3" data-path="tasks.html"><a href="tasks.html#vec_task_2"><i class="fa fa-check"></i><b>19.3</b> Вектор. Индексирование</a></li>
<li class="chapter" data-level="19.4" data-path="tasks.html"><a href="tasks.html#list_ta"><i class="fa fa-check"></i><b>19.4</b> Списки</a></li>
<li class="chapter" data-level="19.5" data-path="tasks.html"><a href="tasks.html#t"><i class="fa fa-check"></i><b>19.5</b> Матрицы</a></li>
<li class="chapter" data-level="19.6" data-path="tasks.html"><a href="tasks.html#df_task"><i class="fa fa-check"></i><b>19.6</b> Датафрейм</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>20</b> Решения_заданий</a><ul>
<li class="chapter" data-level="20.1" data-path="solutions.html"><a href="solutions.html#solvvec_task_1"><i class="fa fa-check"></i><b>20.1</b> Вектор</a></li>
<li class="chapter" data-level="20.2" data-path="solutions.html"><a href="solutions.html#solvvec_op"><i class="fa fa-check"></i><b>20.2</b> Вектор. Операции с векторами</a></li>
<li class="chapter" data-level="20.3" data-path="solutions.html"><a href="solutions.html#solvvec_task_2"><i class="fa fa-check"></i><b>20.3</b> Вектор. Индексирование</a></li>
<li class="chapter" data-level="20.4" data-path="solutions.html"><a href="solutions.html#solvlist_ta"><i class="fa fa-check"></i><b>20.4</b> Списки</a></li>
<li class="chapter" data-level="20.5" data-path="solutions.html"><a href="solutions.html#solvt"><i class="fa fa-check"></i><b>20.5</b> Матрицы</a></li>
<li class="chapter" data-level="20.6" data-path="solutions.html"><a href="solutions.html#solvdf_task"><i class="fa fa-check"></i><b>20.6</b> Датафрейм</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ссылки-на-литературу.html"><a href="ссылки-на-литературу.html"><i class="fa fa-check"></i>Ссылки на литературу</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Наука о данных в R для программы Цифровых гуманитарных исследований</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="корреляция-и-регрессия" class="section level1">
<h1><span class="header-section-number">15</span> Корреляция и регрессия</h1>
<div id="дисперсия-и-стандартное-отклонение" class="section level2">
<h2><span class="header-section-number">15.1</span> Дисперсия и стандартное отклонение</h2>
<p><strong>Дисперсия</strong> — мера разброса значений наблюдений относительно среднего.</p>
<p><span class="math display">\[\sigma^2_X = \frac{\sum_{i = 1}^n(x_i - \bar{x})^2}{n - 1},\]</span></p>
<p>где</p>
<ul>
<li><span class="math inline">\(x_1, ..., x_n\)</span> — наблюдения;</li>
<li><span class="math inline">\(\bar{x}\)</span> — среднее всех наблюдений;</li>
<li><span class="math inline">\(X\)</span> — вектор всех наблюдений;</li>
<li><span class="math inline">\(n\)</span> — количество наблюдений.</li>
</ul>
<p>Представим, что у нас есть следующие данные:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-554-1.png" width="672" /></p>
<p>Тогда дисперсия — это сумма квадратов расстояний от каждой точки до среднего выборки (пунктирная линия) разделенное на количество наблюдений - 1 (по духу эта мера — обычное среднее, но если вас инетересует разница смещенной и несмещенной оценки дисперсии, см. <a href="https://youtu.be/Cn0skMJ2F3c">видео</a>).</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-555-1.png" width="672" /></p>
<p>Для того чтобы было понятнее, что такое дисперсия, давайте рассмотрим несколько расспределений с одним и тем же средним, но разными дисперсиями:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-556-1.png" width="672" /></p>
<p>В R дисперсию можно посчитать при помощи функции <code>var()</code><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>.</p>
<div class="sourceCode" id="cb1100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1100-1"><a href="корреляция-и-регрессия.html#cb1100-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1100-2"><a href="корреляция-и-регрессия.html#cb1100-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1100-3"><a href="корреляция-и-регрессия.html#cb1100-3"></a><span class="kw">var</span>(x)</span></code></pre></div>
<pre><code>[1] 172.2993</code></pre>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1102-1"><a href="корреляция-и-регрессия.html#cb1102-1"></a><span class="kw">var</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">sum</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<p>Так как дисперсия является квадратом отклонения, то часто вместо нее используют более интерпретируемое стандартное отклонение <span class="math inline">\(\sigma\)</span> — корень из дисперсии. В R ее можно посчитать при помощи функции <code>sd()</code>:</p>
<div class="sourceCode" id="cb1104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1104-1"><a href="корреляция-и-регрессия.html#cb1104-1"></a><span class="kw">sd</span>(x)</span></code></pre></div>
<pre><code>[1] 13.12628</code></pre>
<div class="sourceCode" id="cb1106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1106-1"><a href="корреляция-и-регрессия.html#cb1106-1"></a><span class="kw">sd</span>(x) <span class="op">==</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(x))</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="rmdtask">
<p>
Посчитайте дисперсию переменной <code>sleep_total</code> в датасете <code>msleep</code>, встроенный в <code>tidyverse</code>. Ответ округлите до двух знаков после запятой.
</p>
</div>
<form name="form_28559" onsubmit="return validate_form_28559()" method="post">
<input type="text" name="answer_28559"><br><input type="submit" value="check">
</form>
<p id="result_28559">
</p>
<script> function validate_form_28559() {var x, text; var x = document.forms["form_28559"]["answer_28559"].value;if (x == "19.81"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_28559').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Посчитайте стандартное отклонение переменной <code>sleep_total</code> в датасете <code>msleep</code>, встроенный в <code>tidyverse</code>. Ответ округлите до двух знаков после запятой.
</p>
</div>
<form name="form_88261" onsubmit="return validate_form_88261()" method="post">
<input type="text" name="answer_88261"><br><input type="submit" value="check">
</form>
<p id="result_88261">
</p>
<script> function validate_form_88261() {var x, text; var x = document.forms["form_88261"]["answer_88261"].value;if (x == "4.45"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_88261').innerHTML = text; return false;} </script>
</div>
<div id="z-преобразование" class="section level2">
<h2><span class="header-section-number">15.2</span> z-преобразование</h2>
<p><strong>z-преобразование</strong> (еще используют термин <strong>нормализация</strong>) — это способ представления данных в виде расстояний от среднего, измеряемых в стандартных отклонениях. Для того чтобы его получить, нужно из каждого наблюдения вычесть среднее и результат разделить на стандартное отклонение.</p>
<p><span class="math display">\[x_i = \frac{x_i - \bar{x}}{\sigma_X}\]</span></p>
<p>Если все наблюдения z-преобразовать, то получиться распределение с средним в 0 и стандартным отклонением 1 (или очень близко к ним).</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-564-1.png" width="672" /></p>
<p>Само по себе <span class="math inline">\(z\)</span>-преобразование ничего особенного нам про данные не говорит. Однако это преобразование позволяет привести к “общему знаменателю” разные переменные. Т. е. это преобразование ничего нам не говорит про конкретный набор данных, но позволяет сравнивать разные наборы данных.</p>
<p>В R z-преобразование можно сделать при помощи функции <code>scale()</code>. Эта функция вовзращает матрицу, поэтому я использую индекс <code>[,1]</code>, чтобы результат был вектором.</p>
<div class="sourceCode" id="cb1108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1108-1"><a href="корреляция-и-регрессия.html#cb1108-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1108-2"><a href="корреляция-и-регрессия.html#cb1108-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1108-3"><a href="корреляция-и-регрессия.html#cb1108-3"></a><span class="kw">scale</span>(x)[,<span class="dv">1</span>]</span></code></pre></div>
<pre><code> [1]  0.8982271 -0.5764146  0.1304317  0.3359234  0.1617734 -0.2270593
 [7]  1.0053127 -0.2183246  1.3914857 -0.1939880  0.8478787  1.5958251
[13] -1.2042865 -0.3586002 -0.2477787  0.3382758 -0.3627629 -2.1699785
[19] -2.0054319  0.8594918</code></pre>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1110-1"><a href="корреляция-и-регрессия.html#cb1110-1"></a><span class="kw">scale</span>(x)[,<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span>(x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">/</span><span class="kw">sd</span>(x)</span></code></pre></div>
<pre><code> [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE
[16] TRUE TRUE TRUE TRUE TRUE</code></pre>
<div class="rmdtask">
<p>
Однаждый я заполучил градусник со шкалой Фаренгейта и целый год измерял температуру в Москве при помощи градусников с шкалой Фарингейта и Цельсия. <a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/moscow_average_temperature.csv">В датасет</a> записаны средние значения для каждого месяца. Постройте график нормализованных и ненормализованных измерений. Что можно сказать про измерения, сделанные разными термометрами?
</p>
</div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-568-1.png" width="672" /></p>
</div>
<div id="ковариация" class="section level2">
<h2><span class="header-section-number">15.3</span> Ковариация</h2>
<p><strong>Ковариация</strong> — эта мера ассоциации двух переменных.</p>
<p><span class="math display">\[cov(X, Y) = \frac{\sum_{i = 1}^n(x_i - \bar{x})(y_i-\bar{y})}{n - 1},\]</span></p>
<p>где</p>
<ul>
<li><span class="math inline">\((x_1, y_1), ..., (x_n, y_n)\)</span> — пары наблюдений;</li>
<li><span class="math inline">\(\bar{x}, \bar{y}\)</span> — средние наблюдений;</li>
<li><span class="math inline">\(X, Y\)</span> — векторы всех наблюдений;</li>
<li><span class="math inline">\(n\)</span> — количество наблюдений.</li>
</ul>
<p>Представим, что у нас есть следующие данные:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-569-1.png" width="672" /></p>
<p>Тогда, согласно формуле, для каждой точки вычисляется следующая площадь (пуктирными линиями обозначены средние):</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-570-1.png" width="672" /></p>
<p>Если значения <span class="math inline">\(x_i\)</span> и <span class="math inline">\(y_i\)</span> какой-то точки либо оба больше, либо оба меньше средних <span class="math inline">\(\bar{x}\)</span> и <span class="math inline">\(\bar{y}\)</span>, то получившееся произведение будет иметь знак <code>+</code>, если же наоборот — знак <code>-</code>. На графике это показано цветом.</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-571-1.png" width="672" /></p>
<p>Таким образом, если много красных прямоугольников, то значение суммы будет положительное и обозначать положительную связь (чем больше <span class="math inline">\(x\)</span>, тем больше <span class="math inline">\(y\)</span>), а если будет много синий прямоугольников, то значение суммы отрицательное и обозначать положительную связь (чем больше <span class="math inline">\(x\)</span>, тем меньше <span class="math inline">\(y\)</span>). Непосредственно значение ковариации не очень информативно, так как может достаточно сильно варьироваться от датасета к датасету.</p>
<p>В R ковариацию можно посчитать при помощи функции <code>cov()</code>.</p>
<div class="sourceCode" id="cb1112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1112-1"><a href="корреляция-и-регрессия.html#cb1112-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1112-2"><a href="корреляция-и-регрессия.html#cb1112-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1112-3"><a href="корреляция-и-регрессия.html#cb1112-3"></a>y &lt;-<span class="st">  </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1112-4"><a href="корреляция-и-регрессия.html#cb1112-4"></a><span class="kw">cov</span>(x, y)</span></code></pre></div>
<pre><code>[1] 18.72204</code></pre>
<div class="sourceCode" id="cb1114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1114-1"><a href="корреляция-и-регрессия.html#cb1114-1"></a><span class="kw">cov</span>(x, <span class="op">-</span>y<span class="op">*</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1] -37.44407</code></pre>
<p>Как видно, простое умножение на два удвоило значение ковариации, что показывает, что непосредственно ковариацию использовать для сравнения разных датасетов не стоит.</p>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1116-1"><a href="корреляция-и-регрессия.html#cb1116-1"></a><span class="kw">cov</span>(x, y) <span class="op">==</span><span class="st"> </span><span class="kw">sum</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">*</span>(y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)))<span class="op">/</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</div>
<div id="корреляция" class="section level2">
<h2><span class="header-section-number">15.4</span> Корреляция</h2>
<p><strong>Корреляция</strong> — это мера ассоциации/связи двух числовых переменных. Помните, что бытовое применение этого термина к категориальным переменным (например, корреляция цвета глаз и успеваемость на занятиях по R) не имеет смысла с точки зрения статистики.</p>
<div id="корреляция-пирсона" class="section level3">
<h3><span class="header-section-number">15.4.1</span> Корреляция Пирсона</h3>
<p><strong>Коэффициент корреляции Пирсона</strong> — базовый коэффициент ассоциации переменных, однако стоит помнить, что он дает неправильную оценку, если связь между переменными нелинейна.</p>
<p><span class="math display">\[\rho_{X,Y} = \frac{cov(X, Y)}{\sigma_X\times\sigma_Y} = \frac{1}{n-1}\times\sum_{i = 1}^n\left(\frac{x_i-\bar{x}}{\sigma_X}\times\frac{y_i-\bar{y}}{\sigma_Y}\right),\]</span></p>
<p>где</p>
<ul>
<li><span class="math inline">\((x_1, y_1), ..., (x_n, y_n)\)</span> — пары наблюдений;</li>
<li><span class="math inline">\(\bar{x}, \bar{y}\)</span> — средние наблюдений;</li>
<li><span class="math inline">\(X, Y\)</span> — векторы всех наблюдений;</li>
<li><span class="math inline">\(n\)</span> — количество наблюдений.</li>
</ul>
<p>Последнее уравнение показывает, что коэффициент корреляции Пирсона можно представить как среднее (с поправкой, поэтому <span class="math inline">\(n-1\)</span>, а не <span class="math inline">\(n\)</span>) произведение <span class="math inline">\(z\)</span>-нормализованных значений двух переменных.</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-574-1.png" width="672" /></p>
<p>Эта нормализация приводит к тому, что</p>
<ul>
<li>значения корреляции имеют те же свойства знака коэффициента что и ковариация:
<ul>
<li>если коэффициент положительный (т. е. много красных прямоугольников) — связь между переменными положительная (чем <strong>больше</strong> <span class="math inline">\(x\)</span>, тем <strong>больше</strong> <span class="math inline">\(y\)</span>),</li>
<li>если коэффициент отрицательный (т. е. много синих прямоугольников) — связь между переменными отрицательная (чем <strong>больше</strong> <span class="math inline">\(x\)</span>, тем <strong>меньше</strong> <span class="math inline">\(y\)</span>);</li>
</ul></li>
<li>значение корреляции имееет независимое от типа данных интеретация:
<ul>
<li>если модуль коэффициента близок к 1 или ему равен — связь между переменными сильная,</li>
<li>если модуль коэффициента близок к 0 или ему равен — связь между переменными слабая.</li>
</ul></li>
</ul>
<p>Для того чтобы было понятнее, что такое корреляция, давайте рассмотрим несколько расспределений с разными значениями корреляции:</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-575-1.png" width="672" /></p>
<p>Как видно из этого графика, чем ближе модуль корреляции к 1, тем боллее компактно расположены точки друг к другу, чем ближе к 0, тем более рассеяны значения. Достаточно легко научиться приблизительно оценивать коэфициент корреляции на глаз, поиграв 2–5 минут в игру “Угадай корреляцию” <a href="http://guessthecorrelation.com/">здесь</a> или <a href="https://cheng-dsdp.shinyapps.io/CorApp/">здесь</a>.</p>
<p>В R коэффициент корреляции Пирсона можно посчитать при помощи функции <code>cor()</code>.</p>
<div class="sourceCode" id="cb1118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1118-1"><a href="корреляция-и-регрессия.html#cb1118-1"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1118-2"><a href="корреляция-и-регрессия.html#cb1118-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">15</span>, <span class="dt">mean =</span> <span class="dv">50</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1118-3"><a href="корреляция-и-регрессия.html#cb1118-3"></a>y &lt;-<span class="st">  </span>x <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">15</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</span>
<span id="cb1118-4"><a href="корреляция-и-регрессия.html#cb1118-4"></a><span class="kw">cor</span>(x, y)</span></code></pre></div>
<pre><code>[1] 0.6659041</code></pre>
<p>Проверим, что функция выдает то же, что мы записали в формуле.</p>
<div class="sourceCode" id="cb1120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1120-1"><a href="корреляция-и-регрессия.html#cb1120-1"></a><span class="kw">cor</span>(x, y) <span class="op">==</span><span class="st"> </span><span class="kw">cov</span>(x, y)<span class="op">/</span>(<span class="kw">sd</span>(x)<span class="op">*</span><span class="kw">sd</span>(y))</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb1122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1122-1"><a href="корреляция-и-регрессия.html#cb1122-1"></a><span class="kw">cor</span>(x, y) <span class="op">==</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">scale</span>(x)<span class="op">*</span><span class="kw">scale</span>(y))<span class="op">/</span>(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="rmdtask">
<p>
Посчитайте на основе <a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/moscow_average_temperature.csv">датасета с температурой</a> корреляцию между разными измерениями в шкалах Фарингейта и Цельсия? Результаты округлите до трех знаков после запятой.
</p>
</div>
<form name="form_64410" onsubmit="return validate_form_64410()" method="post">
<input type="text" name="answer_64410"><br><input type="submit" value="check">
</form>
<p id="result_64410">
</p>
<script> function validate_form_64410() {var x, text; var x = document.forms["form_64410"]["answer_64410"].value;if (x == "0.997"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_64410').innerHTML = text; return false;} </script>
</div>
<div id="ранговые-корреляции-спирмана-и-кендалла" class="section level3">
<h3><span class="header-section-number">15.4.2</span> Ранговые корреляции Спирмана и Кендалла</h3>
<p>Коэффициент корреляции Пирсона к сожалению, чувствителен к значениям наблюдений. Если связь между переменными нелинейна, то оценка будет получаться смещенной. Рассмотрим, например, словарь [Ляшевской, Шарова 2011]:</p>
<div class="sourceCode" id="cb1124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1124-1"><a href="корреляция-и-регрессия.html#cb1124-1"></a>freqdict &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/freq_dict_2011.csv&quot;</span>)</span>
<span id="cb1124-2"><a href="корреляция-и-регрессия.html#cb1124-2"></a>freqdict <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1124-3"><a href="корреляция-и-регрессия.html#cb1124-3"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(freq_ipm)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1124-4"><a href="корреляция-и-регрессия.html#cb1124-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1124-5"><a href="корреляция-и-регрессия.html#cb1124-5"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>) -&gt;</span>
<span id="cb1124-6"><a href="корреляция-и-регрессия.html#cb1124-6"></a><span class="st">  </span>filered_freqdict</span>
<span id="cb1124-7"><a href="корреляция-и-регрессия.html#cb1124-7"></a></span>
<span id="cb1124-8"><a href="корреляция-и-регрессия.html#cb1124-8"></a>filered_freqdict <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1124-9"><a href="корреляция-и-регрессия.html#cb1124-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(id, freq_ipm, <span class="dt">label =</span> lemma))<span class="op">+</span></span>
<span id="cb1124-10"><a href="корреляция-и-регрессия.html#cb1124-10"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb1124-11"><a href="корреляция-и-регрессия.html#cb1124-11"></a><span class="st">  </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>()<span class="op">+</span></span>
<span id="cb1124-12"><a href="корреляция-и-регрессия.html#cb1124-12"></a><span class="st">  </span><span class="kw">scale_y_log10</span>()</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-580-1.png" width="672" /></p>
<p>В целом корреляция между рангом и частотой должна быть высокая, однако связь между этими переменными нелинейна, так что коэффициент корреляции Пирсона не такой уж и высокий:</p>
<div class="sourceCode" id="cb1125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1125-1"><a href="корреляция-и-регрессия.html#cb1125-1"></a><span class="kw">cor</span>(filered_freqdict<span class="op">$</span>freq_ipm, filered_freqdict<span class="op">$</span>id)</span></code></pre></div>
<pre><code>[1] -0.6307876</code></pre>
<p>Для решения той проблемы обычно используют ранговые коэффециенты коррляции Спирмана и Кендала, которые принимают во внимание ранг значения, а не его непосредственное значение.</p>
<div class="sourceCode" id="cb1127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1127-1"><a href="корреляция-и-регрессия.html#cb1127-1"></a><span class="kw">cor</span>(filered_freqdict<span class="op">$</span>freq_ipm, filered_freqdict<span class="op">$</span>id, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>[1] -1</code></pre>
<div class="sourceCode" id="cb1129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1129-1"><a href="корреляция-и-регрессия.html#cb1129-1"></a><span class="kw">cor</span>(filered_freqdict<span class="op">$</span>freq_ipm, filered_freqdict<span class="op">$</span>id, <span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>[1] -1</code></pre>
<p>Давайте сравним с предыдущими наблюдениями и их логаотфмамиы:</p>
<div class="sourceCode" id="cb1131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1131-1"><a href="корреляция-и-регрессия.html#cb1131-1"></a><span class="kw">cor</span>(x, y) <span class="op">==</span><span class="st"> </span><span class="kw">cor</span>(<span class="kw">log</span>(x), <span class="kw">log</span>(y))</span></code></pre></div>
<pre><code>[1] FALSE</code></pre>
<div class="sourceCode" id="cb1133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1133-1"><a href="корреляция-и-регрессия.html#cb1133-1"></a><span class="kw">cor</span>(x, y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>) <span class="op">==</span><span class="st"> </span><span class="kw">cor</span>(<span class="kw">log</span>(x), <span class="kw">log</span>(y), <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
<div class="sourceCode" id="cb1135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1135-1"><a href="корреляция-и-регрессия.html#cb1135-1"></a><span class="kw">cor</span>(x, y, <span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>) <span class="op">==</span><span class="st"> </span><span class="kw">cor</span>(<span class="kw">log</span>(x), <span class="kw">log</span>(y), <span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<div id="регрессионный-анализ" class="section level2">
<h2><span class="header-section-number">15.5</span> Регрессионный анализ</h2>
<div id="основы" class="section level3">
<h3><span class="header-section-number">15.5.1</span> Основы</h3>
<p>Суть регрессионного анализа в моделировании связи между двумя и более переменными при помощи прямой на плоскости. Формула прямой зависит от двух параметров: свободного члена (intercept) и углового коэффициента (slope).</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-584-1.png" width="672" /></p>
<div class="rmdtask">
<p>
Укажите значение свободного члена для красной прямой.
</p>
</div>
<form name="form_99172" onsubmit="return validate_form_99172()" method="post">
<input type="radio" name="answer_99172" id="99172_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_99172" id="99172_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_99172" id="99172_3" value="0"><label for="3">0</label> <input type="radio" name="answer_99172" id="99172_4" value="1"><label for="4">1</label> <input type="radio" name="answer_99172" id="99172_5" value="2"><label for="5">2</label> <input type="radio" name="answer_99172" id="99172_6" value="3"><label for="6">3</label> <input type="radio" name="answer_99172" id="99172_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_99172">
</p>
<script> function validate_form_99172() {var x, text; var x = document.forms["form_99172"]["answer_99172"].value;if (x == "1"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_99172').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение свободного члена для зеленой прямой.
</p>
</div>
<form name="form_92981" onsubmit="return validate_form_92981()" method="post">
<input type="radio" name="answer_92981" id="92981_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_92981" id="92981_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_92981" id="92981_3" value="0"><label for="3">0</label> <input type="radio" name="answer_92981" id="92981_4" value="1"><label for="4">1</label> <input type="radio" name="answer_92981" id="92981_5" value="2"><label for="5">2</label> <input type="radio" name="answer_92981" id="92981_6" value="3"><label for="6">3</label> <input type="radio" name="answer_92981" id="92981_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_92981">
</p>
<script> function validate_form_92981() {var x, text; var x = document.forms["form_92981"]["answer_92981"].value;if (x == "2"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_92981').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение свободного члена для синей прямой.
</p>
</div>
<form name="form_72614" onsubmit="return validate_form_72614()" method="post">
<input type="radio" name="answer_72614" id="72614_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_72614" id="72614_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_72614" id="72614_3" value="0"><label for="3">0</label> <input type="radio" name="answer_72614" id="72614_4" value="1"><label for="4">1</label> <input type="radio" name="answer_72614" id="72614_5" value="2"><label for="5">2</label> <input type="radio" name="answer_72614" id="72614_6" value="3"><label for="6">3</label> <input type="radio" name="answer_72614" id="72614_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_72614">
</p>
<script> function validate_form_72614() {var x, text; var x = document.forms["form_72614"]["answer_72614"].value;if (x == "3"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_72614').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение углового коэффициента для красной прямой.
</p>
</div>
<form name="form_82901" onsubmit="return validate_form_82901()" method="post">
<input type="radio" name="answer_82901" id="82901_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_82901" id="82901_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_82901" id="82901_3" value="0"><label for="3">0</label> <input type="radio" name="answer_82901" id="82901_4" value="1"><label for="4">1</label> <input type="radio" name="answer_82901" id="82901_5" value="2"><label for="5">2</label> <input type="radio" name="answer_82901" id="82901_6" value="3"><label for="6">3</label> <input type="radio" name="answer_82901" id="82901_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_82901">
</p>
<script> function validate_form_82901() {var x, text; var x = document.forms["form_82901"]["answer_82901"].value;if (x == "1"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_82901').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение углового коэффициента для зеленой прямой.
</p>
</div>
<form name="form_90827" onsubmit="return validate_form_90827()" method="post">
<input type="radio" name="answer_90827" id="90827_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_90827" id="90827_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_90827" id="90827_3" value="0"><label for="3">0</label> <input type="radio" name="answer_90827" id="90827_4" value="1"><label for="4">1</label> <input type="radio" name="answer_90827" id="90827_5" value="2"><label for="5">2</label> <input type="radio" name="answer_90827" id="90827_6" value="3"><label for="6">3</label> <input type="radio" name="answer_90827" id="90827_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_90827">
</p>
<script> function validate_form_90827() {var x, text; var x = document.forms["form_90827"]["answer_90827"].value;if (x == "2"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_90827').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите значение углового коэффициента для синей прямой.
</p>
</div>
<form name="form_47310" onsubmit="return validate_form_47310()" method="post">
<input type="radio" name="answer_47310" id="47310_1" value="-2"><label for="1">-2</label> <input type="radio" name="answer_47310" id="47310_2" value="-1"><label for="2">-1</label> <input type="radio" name="answer_47310" id="47310_3" value="0"><label for="3">0</label> <input type="radio" name="answer_47310" id="47310_4" value="1"><label for="4">1</label> <input type="radio" name="answer_47310" id="47310_5" value="2"><label for="5">2</label> <input type="radio" name="answer_47310" id="47310_6" value="3"><label for="6">3</label> <input type="radio" name="answer_47310" id="47310_7" value="4"><label for="7">4</label> <br><input type="submit" value="check">
</form>
<p id="result_47310">
</p>
<script> function validate_form_47310() {var x, text; var x = document.forms["form_47310"]["answer_47310"].value;if (x == "-1"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_47310').innerHTML = text; return false;} </script>
<p>Когда мы пытаемся научиться предсказывать данные одной переменной <span class="math inline">\(Y\)</span> при помощи другой переменной <span class="math inline">\(X\)</span>, мы получаем похожую формулу:</p>
<p><span class="math display">\[y_i = \hat\beta_0 + \hat\beta_1 \times x_i + \epsilon_i,\]</span>
где</p>
<ul>
<li><span class="math inline">\(x_i\)</span> — <span class="math inline">\(i\)</span>-ый элемент вектора значений <span class="math inline">\(X\)</span>;</li>
<li><span class="math inline">\(y_i\)</span> — <span class="math inline">\(i\)</span>-ый элемент вектора значений <span class="math inline">\(Y\)</span>;</li>
<li><span class="math inline">\(\hat\beta_0\)</span> — оценка случайного члена (intercept);</li>
<li><span class="math inline">\(\hat\beta_1\)</span> — оценка углового коэффициента (slope);</li>
<li><span class="math inline">\(\epsilon_i\)</span> — <span class="math inline">\(i\)</span>-ый остаток, разница между оценкой модели (<span class="math inline">\(\hat\beta_0 + \hat\beta_1 \times x_i\)</span>) и реальным значением <span class="math inline">\(y_i\)</span>; весь вектор остатков иногда называют случайным шумом (на графике выделены красным).</li>
</ul>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-597-1.png" width="672" /></p>
<p>Задача регрессии — оценить параметры <span class="math inline">\(\hat\beta_0\)</span> и <span class="math inline">\(\hat\beta_1\)</span>, если нам известны все значения <span class="math inline">\(x_i\)</span> и <span class="math inline">\(y_i\)</span> и мы пытаемся минимизировать значния <span class="math inline">\(\epsilon_i\)</span>. В данном конкретном случае, задачу можно решить аналитически и получить следующие формулы:</p>
<p><span class="math display">\[\hat\beta_1 = \frac{(\sum_{i=1}^n x_i\times y_i)-n\times\bar x \times \bar y}{\sum_{i = 1}^n(x_i-\bar x)^2}\]</span></p>
<p><span class="math display">\[\hat\beta_0 = \bar y - \hat\beta_1\times\bar x\]</span></p>
</div>
<div id="первая-регрессия" class="section level3">
<h3><span class="header-section-number">15.5.2</span> Первая регрессия</h3>
<p>Давайте попробуем смоделировать количество слов <em>и</em> в рассказах М. Зощенко в зависимости от длины рассказа:</p>
<div class="sourceCode" id="cb1137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1137-1"><a href="корреляция-и-регрессия.html#cb1137-1"></a>zo &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_zoshenko.csv&quot;</span>)</span>
<span id="cb1137-2"><a href="корреляция-и-регрессия.html#cb1137-2"></a></span>
<span id="cb1137-3"><a href="корреляция-и-регрессия.html#cb1137-3"></a>zo <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1137-4"><a href="корреляция-и-регрессия.html#cb1137-4"></a><span class="st">  </span><span class="kw">filter</span>(word <span class="op">==</span><span class="st"> &quot;и&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1137-5"><a href="корреляция-и-регрессия.html#cb1137-5"></a><span class="st">  </span><span class="kw">distinct</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1137-6"><a href="корреляция-и-регрессия.html#cb1137-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(n_words, n))<span class="op">+</span></span>
<span id="cb1137-7"><a href="корреляция-и-регрессия.html#cb1137-7"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb1137-8"><a href="корреляция-и-регрессия.html#cb1137-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;количество слов в рассказе&quot;</span>,</span>
<span id="cb1137-9"><a href="корреляция-и-регрессия.html#cb1137-9"></a>       <span class="dt">y =</span> <span class="st">&quot;количество и&quot;</span>)</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-598-1.png" width="672" /></p>
<p>Мы видим, несколько одиночных точек, давайте избавимся от них и добавим регрессионную линию при помощи функции <code>geom_smooth()</code>:</p>
<div class="sourceCode" id="cb1138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1138-1"><a href="корреляция-и-регрессия.html#cb1138-1"></a>zo <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1138-2"><a href="корреляция-и-регрессия.html#cb1138-2"></a><span class="st">  </span><span class="kw">filter</span>(word <span class="op">==</span><span class="st"> &quot;и&quot;</span>,</span>
<span id="cb1138-3"><a href="корреляция-и-регрессия.html#cb1138-3"></a>         n_words <span class="op">&lt;</span><span class="st"> </span><span class="dv">1500</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1138-4"><a href="корреляция-и-регрессия.html#cb1138-4"></a><span class="st">  </span><span class="kw">distinct</span>() -&gt;</span>
<span id="cb1138-5"><a href="корреляция-и-регрессия.html#cb1138-5"></a><span class="st">  </span>zo_filtered</span>
<span id="cb1138-6"><a href="корреляция-и-регрессия.html#cb1138-6"></a></span>
<span id="cb1138-7"><a href="корреляция-и-регрессия.html#cb1138-7"></a>zo_filtered <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb1138-8"><a href="корреляция-и-регрессия.html#cb1138-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(n_words, n))<span class="op">+</span></span>
<span id="cb1138-9"><a href="корреляция-и-регрессия.html#cb1138-9"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb1138-10"><a href="корреляция-и-регрессия.html#cb1138-10"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)<span class="op">+</span></span>
<span id="cb1138-11"><a href="корреляция-и-регрессия.html#cb1138-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;количество слов в рассказе&quot;</span>,</span>
<span id="cb1138-12"><a href="корреляция-и-регрессия.html#cb1138-12"></a>       <span class="dt">y =</span> <span class="st">&quot;количество и&quot;</span>)</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-599-1.png" width="672" /></p>
<p>Чтобы получить формулу этой линии нужно запустить функцию, которая оценивает линейную регрессию:</p>
<div class="sourceCode" id="cb1139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1139-1"><a href="корреляция-и-регрессия.html#cb1139-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(n<span class="op">~</span>n_words, <span class="dt">data =</span> zo_filtered)</span>
<span id="cb1139-2"><a href="корреляция-и-регрессия.html#cb1139-2"></a>fit</span></code></pre></div>
<pre><code>
Call:
lm(formula = n ~ n_words, data = zo_filtered)

Coefficients:
(Intercept)      n_words  
   -1.47184      0.04405  </code></pre>
<p>Вот мы и получили коэффициенты, теперь мы видим, что наша модель считает следующее:</p>
<p><span class="math display">\[n = -1.47184 + 0.04405 \times n\_words\]</span></p>
<p>Более подробную информцию можно посмотреть, если запустить модель в функцию <code>summary()</code>:</p>
<div class="sourceCode" id="cb1141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1141-1"><a href="корреляция-и-регрессия.html#cb1141-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = n ~ n_words, data = zo_filtered)

Residuals:
     Min       1Q   Median       3Q      Max 
-19.6830  -4.3835   0.8986   4.6486  19.6413 

Coefficients:
             Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept) -1.471840   2.467149  -0.597               0.553    
n_words      0.044049   0.003666  12.015 &lt;0.0000000000000002 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 7.945 on 64 degrees of freedom
Multiple R-squared:  0.6928,    Adjusted R-squared:  0.688 
F-statistic: 144.4 on 1 and 64 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>В разделе <code>Coefficients</code> содержится информацию про наши коэффициенты:</p>
<ul>
<li><code>Estimate</code> – полученная оценка коэффициентов;</li>
<li><code>Std. Error</code> – стандартная ошибка среднего;</li>
<li><code>t value</code> – <span class="math inline">\(t\)</span>-статистика, полученная при проведении одновыборочного <span class="math inline">\(t\)</span>-теста, сравнивающего данный коэфициент с 0;</li>
<li><code>Pr(&gt;|t|)</code> – полученное <span class="math inline">\(p\)</span>-значение;</li>
<li><code>Multiple R-squared</code> и <code>Adjusted R-squared</code> — одна из оценок модели, показывает связь между переменными. Без поправок совпадает с квадратом коэффициента корреляции Пирсона:</li>
</ul>
<div class="sourceCode" id="cb1143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1143-1"><a href="корреляция-и-регрессия.html#cb1143-1"></a><span class="kw">cor</span>(zo_filtered<span class="op">$</span>n_words, zo_filtered<span class="op">$</span>n)<span class="op">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>[1] 0.6928376</code></pre>
<ul>
<li><code>F-statistic</code> — <span class="math inline">\(F\)</span>-статистика полученная при проведении теста, проверяющего, не являются ли хотя бы один из коэффицинтов статистически значимо отличается от нуля. Совпадает с результатами дисперсионного анализа (ANOVA).</li>
</ul>
<p>Теперь мы можем даже предсказывать значения, которые мы еще не видели. Например, сколько будет и в рассказе Зощенко длиной 1000 слов?</p>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-603-1.png" width="672" /></p>
<div class="sourceCode" id="cb1145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1145-1"><a href="корреляция-и-регрессия.html#cb1145-1"></a><span class="kw">predict</span>(fit, <span class="kw">tibble</span>(<span class="dt">n_words =</span> <span class="dv">1000</span>))</span></code></pre></div>
<pre><code>       1 
42.57715 </code></pre>
<div class="rmdtask">
<p>
Постройте ленейную ргерессию на основании <a href="https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_chekhov.tsv">рассказов А. Чехова</a>, предсказывая количество и на основании количства слов. При моделировании используйте только рассказы длиной меньше 2500 слов. Укажите свободный член получившейся модели, округлив его до 3 знаков после запятой.
</p>
</div>
<form name="form_26912" onsubmit="return validate_form_26912()" method="post">
<input type="text" name="answer_26912"><br><input type="submit" value="check">
</form>
<p id="result_26912">
</p>
<script> function validate_form_26912() {var x, text; var x = document.forms["form_26912"]["answer_26912"].value;if (x == "-0.814"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_26912').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите угловой коффициент получившейся модели, округлив его до 3 знаков после запятой.
</p>
</div>
<form name="form_91421" onsubmit="return validate_form_91421()" method="post">
<input type="text" name="answer_91421"><br><input type="submit" value="check">
</form>
<p id="result_91421">
</p>
<script> function validate_form_91421() {var x, text; var x = document.forms["form_91421"]["answer_91421"].value;if (x == "0.044"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_91421').innerHTML = text; return false;} </script>
<div class="rmdtask">
<p>
Укажите предсказания модели для рассказа длиной 1000 слов, округлив получнное значение до 3 знаков после запятой.
</p>
</div>
<form name="form_63084" onsubmit="return validate_form_63084()" method="post">
<input type="text" name="answer_63084"><br><input type="submit" value="check">
</form>
<p id="result_63084">
</p>
<script> function validate_form_63084() {var x, text; var x = document.forms["form_63084"]["answer_63084"].value;if (x == "42.771"){text = 'Correct';} else {text = 'I have a different answer';} document.getElementById('result_63084').innerHTML = text; return false;} </script>
</div>
<div id="категориальные-переменные-1" class="section level3">
<h3><span class="header-section-number">15.5.3</span> Категориальные переменные</h3>
<p>Что если мы хотим включить в наш анализ категориальные переменные? Давайте рассмотрим простой пример с <a href="https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_chekhov.tsv">рассказами Чехова</a> и <a href="https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_zoshenko.csv">Зощенко</a>, которые мы рассматривали в прошлом разделе. Мы будем анализировать логарифм доли слов деньги:</p>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="корреляция-и-регрессия.html#cb1147-1"></a>chekhov &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_chekhov.tsv&quot;</span>)</span>
<span id="cb1147-2"><a href="корреляция-и-регрессия.html#cb1147-2"></a>zoshenko &lt;-<span class="st"> </span><span class="kw">read_tsv</span>(<span class="st">&quot;https://github.com/agricolamz/DS_for_DH/raw/master/data/tidy_zoshenko.csv&quot;</span>)</span>
<span id="cb1147-3"><a href="корреляция-и-регрессия.html#cb1147-3"></a></span>
<span id="cb1147-4"><a href="корреляция-и-регрессия.html#cb1147-4"></a>chekhov<span class="op">$</span>author &lt;-<span class="st"> &quot;Чехов&quot;</span></span>
<span id="cb1147-5"><a href="корреляция-и-регрессия.html#cb1147-5"></a>zoshenko<span class="op">$</span>author &lt;-<span class="st"> &quot;Зощенко&quot;</span></span>
<span id="cb1147-6"><a href="корреляция-и-регрессия.html#cb1147-6"></a></span>
<span id="cb1147-7"><a href="корреляция-и-регрессия.html#cb1147-7"></a>chekhov <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1147-8"><a href="корреляция-и-регрессия.html#cb1147-8"></a><span class="st">  </span><span class="kw">bind_rows</span>(zoshenko) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1147-9"><a href="корреляция-и-регрессия.html#cb1147-9"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(word, <span class="st">&quot;деньг&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1147-10"><a href="корреляция-и-регрессия.html#cb1147-10"></a><span class="st">  </span><span class="kw">group_by</span>(author, titles, n_words) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1147-11"><a href="корреляция-и-регрессия.html#cb1147-11"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1147-12"><a href="корреляция-и-регрессия.html#cb1147-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_ratio =</span> <span class="kw">log</span>(n<span class="op">/</span>n_words)) -&gt;</span>
<span id="cb1147-13"><a href="корреляция-и-регрессия.html#cb1147-13"></a><span class="st">  </span>checkov_zoshenko</span></code></pre></div>
<p>Визуализация выглядит так:
<img src="DS_for_DH_files/figure-html/unnamed-chunk-612-1.png" width="672" /></p>
<p>Красной точкой обозначены средние значения, так что мы видим, что между двумя писателями есть разница, но является ли она статистически значимой? В прошлом разделе, мы рассмотрели, что в таком случае можно сделать t-test:</p>
<div class="sourceCode" id="cb1148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1148-1"><a href="корреляция-и-регрессия.html#cb1148-1"></a><span class="kw">t.test</span>(log_ratio<span class="op">~</span>author, </span>
<span id="cb1148-2"><a href="корреляция-и-регрессия.html#cb1148-2"></a>       <span class="dt">data =</span> checkov_zoshenko, </span>
<span id="cb1148-3"><a href="корреляция-и-регрессия.html#cb1148-3"></a>       <span class="dt">var.equal =</span><span class="ot">TRUE</span>) <span class="co"># здесь я мухлюю, отключая поправку Уэлча</span></span></code></pre></div>
<pre><code>
    Two Sample t-test

data:  log_ratio by author
t = 5.6871, df = 125, p-value = 0.00000008665
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.8606107 1.7793181
sample estimates:
mean in group Зощенко   mean in group Чехов 
            -5.021262             -6.341226 </code></pre>
<p>Разница между группами является статистически значимой (t(125) = 5.6871, p-value = 8.665e-08).</p>
<p>Для того, чтобы запустить регрессию на категориальных данных категориальная переменная автоматически разбивается на группу бинарных dummy-переменных:</p>
<div class="sourceCode" id="cb1150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1150-1"><a href="корреляция-и-регрессия.html#cb1150-1"></a><span class="kw">tibble</span>(<span class="dt">author =</span> <span class="kw">c</span>(<span class="st">&quot;Чехов&quot;</span>, <span class="st">&quot;Зощенко&quot;</span>),</span>
<span id="cb1150-2"><a href="корреляция-и-регрессия.html#cb1150-2"></a>       <span class="dt">dummy_chekhov =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1150-3"><a href="корреляция-и-регрессия.html#cb1150-3"></a>       <span class="dt">dummy_zoshenko =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["author"],"name":[1],"type":["chr"],"align":["left"]},{"label":["dummy_chekhov"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dummy_zoshenko"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Чехов","2":"1","3":"0"},{"1":"Зощенко","2":"0","3":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Дальше для регрессионного анализа выкидывают одну из переменных, так как иначе модель не сойдется (dummy-переменных всегда n-1, где n — количество категорий в переменной).</p>
<div class="sourceCode" id="cb1151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1151-1"><a href="корреляция-и-регрессия.html#cb1151-1"></a><span class="kw">tibble</span>(<span class="dt">author =</span> <span class="kw">c</span>(<span class="st">&quot;Чехов&quot;</span>, <span class="st">&quot;Зощенко&quot;</span>),</span>
<span id="cb1151-2"><a href="корреляция-и-регрессия.html#cb1151-2"></a>       <span class="dt">dummy_chekhov =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["author"],"name":[1],"type":["chr"],"align":["left"]},{"label":["dummy_chekhov"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Чехов","2":"1"},{"1":"Зощенко","2":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Если переменная <code>dummy_chekhov</code> принимает значение 1, значит речь о рассказе Чехова, а если принимает значение 0, то о рассказе Зощенко. Если вставить нашу переменную в регрессионную формулу получится следующее:</p>
<p><span class="math display">\[y_i = \hat\beta_0 + \hat\beta_1 \times \text{dummy_chekhov} + \epsilon_i,\]</span></p>
<p>Так как <code>dummy_chekhov</code> принимает либо значение 1, либо значение 0, то получается, что модель предсказывает лишь два значения:</p>
<p><span class="math display">\[y_i = \left\{\begin{array}{ll}\hat\beta_0 + \hat\beta_1 \times 1 + \epsilon_i = \hat\beta_0 + \hat\beta_1 + \epsilon_i\text{, если рассказ Чехова}\\ 
\hat\beta_0 + \hat\beta_1 \times 0 + \epsilon_i = \hat\beta_0 + \epsilon_i\text{, если рассказ Зощенко}
\end{array}\right.\]</span></p>
<p>Таким образом, получается, что свободный член <span class="math inline">\(\beta_0\)</span> и угловой коэффициент <span class="math inline">\(\beta_1\)</span> в регресси с категориальной переменной получает другую интерпретацию. Одно из значений переменной кодируется при помощи <span class="math inline">\(\beta_0\)</span>, а сумма коэффициентов <span class="math inline">\(\beta_0+\beta_1\)</span> дают другое значение переменной. Так что <span class="math inline">\(\beta_1\)</span> — это разница между оценками двух значений переменной.</p>
<p>Давайте теперь запустим регрессию на этих же данных:</p>
<div class="sourceCode" id="cb1152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1152-1"><a href="корреляция-и-регрессия.html#cb1152-1"></a>fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(log_ratio<span class="op">~</span>author, <span class="dt">data =</span> checkov_zoshenko)</span>
<span id="cb1152-2"><a href="корреляция-и-регрессия.html#cb1152-2"></a><span class="kw">summary</span>(fit2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = log_ratio ~ author, data = checkov_zoshenko)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8652 -0.6105 -0.0607  0.6546  3.2398 

Coefficients:
            Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)  -5.0213     0.2120 -23.680 &lt; 0.0000000000000002 ***
authorЧехов  -1.3200     0.2321  -5.687         0.0000000867 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9717 on 125 degrees of freedom
Multiple R-squared:  0.2056,    Adjusted R-squared:  0.1992 
F-statistic: 32.34 on 1 and 125 DF,  p-value: 0.00000008665</code></pre>
<p>Во-первых стоит обратить внимание на то, что R сам преобразовал нашу категориальную переменную в dummy-переменную <code>authorЧехов</code>. Во-вторых, можно заметить, что значения t-статистики и p-value совпадают с результатами полученными нами в t-тесте выше. Статистическти значимый коэффициент при аргументе <code>authorЧехов</code> следует интерпретировать как разницу средних между логарифмом долей в рассказах Чехова и Зощенко.</p>
<div class="rmdtask">
<p>
В работе (Coretta 2017, <a href="https://goo.gl/NrfgJm" class="uri">https://goo.gl/NrfgJm</a>) рассматривается отношения между длительностью гласного и придыхание согласного. Автор собрал данные 5 носителей исландского. Дальше он извлек длительность гласного, после которого были придыхательные и непридыхательные. Скачайте <a href="https://raw.githubusercontent.com/agricolamz/DS_for_DH/master/data/icelandic.csv">данные</a> и постройте регрессионную модель, предсказывающую длительность гласного на основе .
</p>
</div>
</div>
<div id="множественная-регрессия" class="section level3">
<h3><span class="header-section-number">15.5.4</span> Множественная регрессия</h3>
<p>Множественная регрессия позволяет проанализировать связь между зависимой и несколькими зависимыми переменными. Формула множественной регрессии не сильно отличается от формулы обычной линейной регрессии:</p>
<p><span class="math display">\[y_i = \hat\beta_0 + \hat\beta_1 \times x_{1i}+ \dots+ \hat\beta_n \times x_{ni} + \epsilon_i,\]</span></p>
<ul>
<li><span class="math inline">\(x_{ki}\)</span> — <span class="math inline">\(i\)</span>-ый элемент векторов значений <span class="math inline">\(X_1, \dots, X_n\)</span>;</li>
<li><span class="math inline">\(y_i\)</span> — <span class="math inline">\(i\)</span>-ый элемент вектора значений <span class="math inline">\(Y\)</span>;</li>
<li><span class="math inline">\(\hat\beta_0\)</span> — оценка случайного члена (intercept);</li>
<li><span class="math inline">\(\hat\beta_k\)</span> — коэфциент при переменной <span class="math inline">\(X_{k}\)</span>;</li>
<li><span class="math inline">\(\epsilon_i\)</span> — <span class="math inline">\(i\)</span>-ый остаток, разница между оценкой модели (<span class="math inline">\(\hat\beta_0 + \hat\beta_1 \times x_i\)</span>) и реальным значением <span class="math inline">\(y_i\)</span>; весь вектор остатков иногда называют случайным шумом.</li>
</ul>
<p>В такой регресии предикторы могут быть как числовыми, так и категориальными (со всеми вытекающими последствиями, которые мы обсудили в предудщем разделе). Такую регрессию чаще всего сложно визуализировать, так как в одну регрессионную линию вкладываются сразу несколько переменных.</p>
<p>Попробуем предсказать длину лепестка на основе длины чашелистик и вида ириса:</p>
<div class="sourceCode" id="cb1154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1154-1"><a href="корреляция-и-регрессия.html#cb1154-1"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1154-2"><a href="корреляция-и-регрессия.html#cb1154-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, Petal.Length, <span class="dt">color =</span> Species))<span class="op">+</span></span>
<span id="cb1154-3"><a href="корреляция-и-регрессия.html#cb1154-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-618-1.png" width="672" /></p>
<p>Запустим регрессию:</p>
<div class="sourceCode" id="cb1155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1155-1"><a href="корреляция-и-регрессия.html#cb1155-1"></a>fit3 &lt;-<span class="st"> </span><span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length<span class="op">+</span><span class="st"> </span>Species, <span class="dt">data =</span> iris)</span>
<span id="cb1155-2"><a href="корреляция-и-регрессия.html#cb1155-2"></a><span class="kw">summary</span>(fit3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Petal.Length ~ Sepal.Length + Species, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.76390 -0.17875  0.00716  0.17461  0.79954 

Coefficients:
                  Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)       -1.70234    0.23013  -7.397      0.0000000000101 ***
Sepal.Length       0.63211    0.04527  13.962 &lt; 0.0000000000000002 ***
Speciesversicolor  2.21014    0.07047  31.362 &lt; 0.0000000000000002 ***
Speciesvirginica   3.09000    0.09123  33.870 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.2826 on 146 degrees of freedom
Multiple R-squared:  0.9749,    Adjusted R-squared:  0.9744 
F-statistic:  1890 on 3 and 146 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p>Все предикторы статистически значимы. Давайте посмотрим предсказания модели для всех наблюдений:</p>
<div class="sourceCode" id="cb1157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1157-1"><a href="корреляция-и-регрессия.html#cb1157-1"></a>iris <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1157-2"><a href="корреляция-и-регрессия.html#cb1157-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prediction =</span> <span class="kw">predict</span>(fit3)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1157-3"><a href="корреляция-и-регрессия.html#cb1157-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sepal.Length, prediction, <span class="dt">color =</span> Species))<span class="op">+</span></span>
<span id="cb1157-4"><a href="корреляция-и-регрессия.html#cb1157-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-620-1.png" width="672" /></p>
<p>Всегда имеет смысл визуализировать, что нам говорит наша модель. Если использовать пакет <code>ggeffects</code> (или предшествовавший ему пакет <code>effects</code>), это можно сделать не сильно задумываясь, как это делать:</p>
<div class="sourceCode" id="cb1158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1158-1"><a href="корреляция-и-регрессия.html#cb1158-1"></a><span class="kw">library</span>(ggeffects)</span>
<span id="cb1158-2"><a href="корреляция-и-регрессия.html#cb1158-2"></a><span class="kw">plot</span>(<span class="kw">ggpredict</span>(fit3, <span class="dt">terms =</span> <span class="kw">c</span>(<span class="st">&quot;Sepal.Length&quot;</span>, <span class="st">&quot;Species&quot;</span>)))</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-621-1.png" width="672" /></p>
<p>Как видно из графиков, наша модель имеет одинаковые угловые коэффициенты (slope) для каждого из видов ириса и разные свободные члены (intercept).</p>
<div class="sourceCode" id="cb1159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1159-1"><a href="корреляция-и-регрессия.html#cb1159-1"></a><span class="kw">summary</span>(fit3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Petal.Length ~ Sepal.Length + Species, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.76390 -0.17875  0.00716  0.17461  0.79954 

Coefficients:
                  Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)       -1.70234    0.23013  -7.397      0.0000000000101 ***
Sepal.Length       0.63211    0.04527  13.962 &lt; 0.0000000000000002 ***
Speciesversicolor  2.21014    0.07047  31.362 &lt; 0.0000000000000002 ***
Speciesvirginica   3.09000    0.09123  33.870 &lt; 0.0000000000000002 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.2826 on 146 degrees of freedom
Multiple R-squared:  0.9749,    Adjusted R-squared:  0.9744 
F-statistic:  1890 on 3 and 146 DF,  p-value: &lt; 0.00000000000000022</code></pre>
<p><span class="math display">\[y_i = \left\{\begin{array}{ll} -1.70234 + 0.63211 \times \text{Sepal.Length} + \epsilon_i\text{, если вид setosa}\\ 
-1.70234 + 2.2101 + 0.63211 \times \text{Sepal.Length} + \epsilon_i\text{, если вид versicolor} \\
-1.70234 + 3.09 + 0.63211 \times \text{Sepal.Length} + \epsilon_i\text{, если вид virginica}
\end{array}\right.\]</span></p>
</div>
<div id="сравнение-моделей" class="section level3">
<h3><span class="header-section-number">15.5.5</span> Сравнение моделей</h3>
<p>Как нам решить, какая модель лучше? Ведь теперь можно добавить сколько угодно предикторов? Давайте создадим новую модель без предиктора <code>Species</code>:</p>
<div class="sourceCode" id="cb1161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1161-1"><a href="корреляция-и-регрессия.html#cb1161-1"></a>fit4 &lt;-<span class="st"> </span><span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length, <span class="dt">data =</span> iris)</span></code></pre></div>
<ul>
<li>можно сравнивать статистическую значимость предикторов</li>
<li>можно сравнивать <span class="math inline">\(R^2\)</span></li>
</ul>
<div class="sourceCode" id="cb1162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1162-1"><a href="корреляция-и-регрессия.html#cb1162-1"></a><span class="kw">summary</span>(fit3)<span class="op">$</span>adj.r.squared</span></code></pre></div>
<pre><code>[1] 0.9743786</code></pre>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1164-1"><a href="корреляция-и-регрессия.html#cb1164-1"></a><span class="kw">summary</span>(fit4)<span class="op">$</span>adj.r.squared</span></code></pre></div>
<pre><code>[1] 0.7583327</code></pre>
<ul>
<li>чаще всего используют так называемые информационные критерии, самый популярный – AIC (Akaike information criterion). Сами по себе значение этого критерия не имеет значения – только в сравнении моделей, построенных на похожих данных. Чем меньше значение, тем модель лучше.</li>
</ul>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1166-1"><a href="корреляция-и-регрессия.html#cb1166-1"></a><span class="kw">AIC</span>(fit3, fit4)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"52.47418","_rn_":"fit3"},{"1":"3","2":"387.13500","_rn_":"fit4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="послесловие-1" class="section level3">
<h3><span class="header-section-number">15.5.6</span> Послесловие</h3>
<ul>
<li>сущетсвуют ограничения на применение линейной регресии
<ul>
<li>связь между предсказываемой переменной и предикторами должна быть линейной</li>
<li>остатки должны быть нормально распределены (оценивайте визуально)</li>
<li>дисперсия остатков вокруг регрессионной линии должно быть постоянно (гомоскидастично)</li>
<li>предикторы не должны коррелировать друг с другом</li>
<li>все наблюдения в регрессии должны быть независимы друг от друга</li>
</ul></li>
</ul>
<p>Вот так вот выглядят остатки нашей модели на основе датасета <code>iris</code>. Смотрите <a href="https://www.qualtrics.com/support/stats-iq/analyses/regression-guides/interpreting-residual-plots-improve-regression/">пост</a>, в котором обсуждается, как интерпретировать график остатков.</p>
<div class="sourceCode" id="cb1167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1167-1"><a href="корреляция-и-регрессия.html#cb1167-1"></a><span class="kw">plot</span>(fit3, <span class="dt">which=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="DS_for_DH_files/figure-html/unnamed-chunk-626-1.png" width="672" /><img src="DS_for_DH_files/figure-html/unnamed-chunk-626-2.png" width="672" /></p>
<ul>
<li>сущетсвуют трюки, позволяющие автоматически отбирать модели (см. функцию <code>step()</code>)</li>
<li>существует достаточно большое семейство регрессий, который зависят от типа независимой (предсказываемой) переменной или ее распределения
<ul>
<li>логистическая (если предсказываемая переменная имеет два возможных исхода)</li>
<li>мультиномиальная (если предсказываемая переменная имеет больше двух возможных дискретных исхода)</li>
<li>нелиненые регресии (если связь между переменными нелинейна)</li>
<li>регрессия со смешанными эффектами (если внутри данных есть группировки, т. е. наблюдения не независимы)</li>
<li>и другие.</li>
</ul></li>
</ul>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>Как и в других функциях, вычисляющих описательную статистику (<code>mean()</code>, <code>median()</code>, <code>max()</code>, <code>min()</code> и др.), функция <code>var()</code> (и все остальные функции, которые мы будем обсуждать <code>sd()</code>, <code>cov()</code>) возвращают <code>NA</code>, если в векторе есть пропущенные значения. Чтобы изменить это поведение, нужно добавить аргумент <code>na.rm = TRUE</code>.<a href="корреляция-и-регрессия.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="проверка-статистических-гипотез.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="работа-статистического-детектива.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/agricolamz/DS_for_DH/edit/master/14-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DS_for_DH.pdf", "DS_for_DH.epub"],
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
